{"version":3,"sources":["../../../../src/components/VDatePicker/VDatePickerDates.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VDatePickerDates.scss'\n\n// Vue API\nimport { h, ref, inject, computed, watch, defineComponent } from 'vue'\n\n// Helpers\nimport { genTableRows, parseDate } from './helpers'\n\n// Effects\nimport { useTransition } from '../../effects/use-transition'\n\n// Types\nimport { VNode, Ref } from 'vue'\nimport { DatePickerBtnHandlers, DatePickerDate } from '../../types'\n\ntype UpdateParams = {\n  month?: number\n  year?: number\n}\n\nexport const VDatePickerDates = defineComponent({\n  name: 'v-date-picker-dates',\n\n  props: {\n    localWeek: Array,\n    year: [String, Number],\n    month: [String, Number],\n    date: [String, Number],\n    value: Object,\n    mondayFirst: Boolean,\n  } as any,\n\n  setup(props, { emit }): () => VNode {\n    const FIRST_MONTH = 0\n    const LAST_MONTH = 11\n    const WEEK = [0, 1, 2, 3, 4, 5, 6]\n    const ANIMATION_TIMEOUT = 100\n\n    const dates = ref<(Date | null)[]>([])\n    const isDatesChanged = ref<boolean>(false)\n    const today = parseDate(new Date())\n\n    const handlers = inject('handlers') as Ref<DatePickerBtnHandlers>\n\n    handlers.value = {\n      onNext: () => updateMonth(true),\n      onPrev: () => updateMonth(false),\n    }\n\n    if (props.mondayFirst) {\n      WEEK.push(WEEK.splice(0, 1)[0])\n    }\n\n    const daysInMonth = computed<number>(() => {\n      return new Date(props.year, props.month + 1, 0).getDate()\n    })\n\n    watch(\n      () => props.month,\n      () => genTableDates(),\n      { immediate: true },\n    )\n\n    watch(\n      () => isDatesChanged.value,\n      () =>\n        setTimeout(() => {\n          isDatesChanged.value = false\n        }, ANIMATION_TIMEOUT),\n    )\n\n    function updateMonth(isNext: boolean) {\n      const params: UpdateParams = {}\n\n      params.month = props.month + (isNext ? 1 : -1)\n\n      if (!isNext && params.month! < FIRST_MONTH) params.month = LAST_MONTH\n      if (isNext && params.month! > LAST_MONTH) params.month = FIRST_MONTH\n      if (isNext && !params.month) params.year = props.year + 1\n      if (!isNext && params.month === LAST_MONTH) params.year = props.year - 1\n\n      isDatesChanged.value = true\n      emit('update:month', params)\n    }\n\n    function genWeekDays(): VNode[] {\n      const propsData = {\n        class: 'v-date-picker-dates__day',\n      }\n\n      return WEEK.map(day =>\n        h('span', propsData, props.localWeek![day] as string),\n      )\n    }\n\n    function genDateObject(date): DatePickerDate {\n      const { year, month } = props\n      return parseDate(new Date(year, month, date))\n    }\n\n    function setEmptiesBeforeFirstDate(dateObject) {\n      const firstDay = WEEK[0]\n\n      const startDay = firstDay && !dateObject.day ?\n        dateObject.day :\n        firstDay\n\n      const tillDay = firstDay && !dateObject.day ?\n        WEEK.length - 1 :\n        dateObject.day\n\n      for (let i = startDay; i <= tillDay; i += 1) {\n        dates.value[i] = { date: null } as any\n      }\n\n      dates.value[tillDay] = dateObject\n    }\n\n    function genTableDates() {\n      dates.value = []\n\n      for (let i = 1; i <= daysInMonth.value; i += 1) {\n        const dateObject = genDateObject(i)\n\n        if (i === 1) {\n          setEmptiesBeforeFirstDate(dateObject)\n        } else {\n          dates.value[dates.value.length] = dateObject as any\n        }\n      }\n    }\n\n    function compareDates(date1, date2) {\n      return (\n        date1.date === date2.date &&\n        date1.month === date2.month &&\n        date1.year === date2.year\n      )\n    }\n\n    function genDateCell(dateObject): VNode {\n      const propsData = {\n        class: {\n          'v-date-picker-dates__cell': !!dateObject.date,\n          'v-date-picker-dates__cell--empty': !dateObject.date,\n          'v-date-picker-dates__cell--selected': compareDates(dateObject, props.value),\n          'v-date-picker-dates__cell--current-date': compareDates(dateObject, today),\n          'v-date-picker-dates__cell--holiday': dateObject.isHoliday,\n        },\n        onClick: () => dateObject.date && emit('update:value', dateObject),\n      }\n\n      return h('div', propsData, dateObject.date)\n    }\n\n    function genDateCells(): VNode[] {\n      return dates.value.reduce((acc, dateObject) => {\n        acc.push(genDateCell(dateObject))\n        return acc\n      }, [] as any)\n    }\n\n    function genDateRows(): VNode[] {\n      const datesVNodes = genDateCells()\n\n      return genTableRows(\n        datesVNodes,\n        'v-date-picker-dates__row',\n        WEEK.length\n      )\n    }\n\n    function genDates(): VNode | null {\n      return ((!isDatesChanged.value &&\n        h('div', { class: 'v-date-picker-dates__dates' }, genDateRows())\n      ) || null)\n    }\n\n    function genWeek(): VNode {\n      return h('div',\n        { class: 'v-date-picker-dates__week' },\n        genWeekDays()\n      )\n    }\n\n    return () =>\n      h('div', { class: 'v-date-picker-dates' },\n        [\n          genWeek(),\n          useTransition(genDates() as any, 'fade'),\n        ]\n      )\n  },\n})\n"],"sourceRoot":"","file":"VDatePickerDates.js"}