{"version":3,"sources":["../../../../src/components/VDatePicker/VYears.ts"],"names":[],"mappings":";;;;;;;AACA;;AAGA;;AAGA;;AAOA;;AAEO,IAAM,MAAM,GAAG,0BAAgB;AACpC,EAAA,IAAI,EAAE,SAD8B;AAEpC,EAAA,KAAK,EAAE;AACL,IAAA,IAAI,EAAE,CAAC,MAAD,EAAS,MAAT;AADD,GAF6B;AAMpC,EAAA,KANoC,iBAM9B,KAN8B,QAMf;AAAA,QAAN,IAAM,QAAN,IAAM;AACnB,QAAM,KAAK,GAAG,GAAd;AACA,QAAM,QAAQ,GAAG,EAAjB;AACA,QAAM,YAAY,GAAG,CAArB;AACA,QAAM,YAAY,GAAG,IAAI,IAAJ,GAAW,WAAX,EAArB;AACA,QAAM,iBAAiB,GAAG,GAA1B;AAEA,QAAM,KAAK,GAAG,cAAqB,EAArB,CAAd;AACA,QAAM,YAAY,GAAG,cAAY,CAAZ,CAArB;AACA,QAAM,aAAa,GAAG,cAAa,KAAb,CAAtB;AACA,QAAM,UAAU,GAAG,cAAY,EAAZ,CAAnB;AAEA,QAAM,QAAQ,GAAG,iBAAO,UAAP,CAAjB;AAEA,0BACE;AAAA,aAAM,aAAa,CAAC,KAAd,IACJ,UAAU,CAAC,YAAK;AACd,QAAA,aAAa,CAAC,KAAd,GAAsB,KAAtB;AACD,OAFS,EAEP,iBAFO,CADZ;AAAA,KADF;AAOA,QAAM,YAAY,GAAG,mBAAiB;AACpC,MAAA,GADoC,iBACjC;AACD,eAAO,CAAC,KAAK,CAAC,IAAP,IAAgB,YAAvB;AACD,OAHmC;AAIpC,MAAA,GAJoC,eAIhC,GAJgC,EAIrB;AACb,QAAA,IAAI,CAAC,aAAD,EAAgB,GAAhB,CAAJ;AACD;AANmC,KAAjB,CAArB;;AASA,QAAI,QAAJ,aAAI,QAAJ,eAAI,QAAQ,CAAE,KAAd,EAAqB;AACnB,MAAA,QAAQ,CAAC,KAAT,GAAiB;AACf,QAAA,MAAM,EAAE;AAAA,iBAAM,eAAe,CAAC,IAAD,CAArB;AAAA,SADO;AAEf,QAAA,MAAM,EAAE;AAAA,iBAAM,eAAe,CAAC,KAAD,CAArB;AAAA;AAFO,OAAjB;AAID;;AAED,aAAS,oBAAT,CAA8B,MAA9B,EAAoC;AAClC,MAAA,UAAU,CAAC,KAAX,GAAmB,MAAM,GAAG,cAAH,GAAoB,YAA7C;AACD;;AAED,aAAS,aAAT,GAAsB;AACpB,MAAA,YAAY,CAAC,KAAb,GAAqB,KAAK,CAAC,KAAN,CAAY,SAAZ,CAAsB,UAAA,GAAG,EAAG;AAC/C,eAAO,GAAG,CAAC,IAAJ,CAAS,UAAA,IAAI;AAAA,iBAAI,IAAI,KAAK,YAAY,CAAC,KAA1B;AAAA,SAAb,CAAP;AACD,OAFoB,CAArB;AAGD;;AAED,aAAS,eAAT,CAAyB,MAAzB,EAA+B;AAC7B,UAAM,GAAG,GAAG,KAAK,CAAC,KAAN,CAAY,MAAZ,GAAqB,CAAjC;AACA,UAAM,GAAG,GAAG,MAAM,GAAG,CAAH,GAAO,CAAC,CAA1B;AAEA,UACG,YAAY,CAAC,KAAb,KAAuB,GAAvB,IAA8B,GAAG,GAAG,CAArC,IACC,YAAY,CAAC,KAAb,KAAuB,CAAvB,IAA4B,GAAG,GAAG,CAFrC,EAGE;AAEF,MAAA,oBAAoB,CAAC,MAAD,CAApB;AAEA,MAAA,YAAY,CAAC,KAAb,IAAsB,GAAtB;AACA,MAAA,aAAa,CAAC,KAAd,GAAsB,IAAtB;AACD;;AAED,aAAS,aAAT,GAAsB;AACpB,UAAM,QAAQ,GAAG,YAAY,GAAG,KAAhC;AACA,UAAM,QAAQ,GAAG,KAAK,GAAG,CAAzB;AAEA,UAAI,SAAS,GAAa,EAA1B;;AAEA,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,IAAI,QAArB,EAA+B,CAAC,IAAI,CAApC,EAAuC;AACrC,YAAI,SAAS,CAAC,MAAV,KAAqB,QAAzB,EAAmC;AACjC,UAAA,KAAK,CAAC,KAAN,CAAY,IAAZ,CAAiB,SAAjB;AACA,UAAA,SAAS,GAAG,EAAZ;AACD;;AACD,QAAA,SAAS,CAAC,IAAV,CAAe,QAAQ,GAAG,CAA1B;AACD;AACF;;AAED,aAAS,WAAT,CAAqB,IAArB,EAAyB;AACvB,UAAM,UAAU,GAAG,IAAI,KAAK,YAAY,CAAC,KAAzC;AACA,UAAM,SAAS,GAAG;AAChB,iBAAO;AACL,2BAAiB,IADZ;AAEL,qCAA2B,UAFtB;AAGL,yCAA+B,IAAI,KAAK;AAHnC,SADS;AAMhB,QAAA,OAAO,EAAE;AAAA,iBAAO,YAAY,CAAC,KAAb,GAAqB,IAA5B;AAAA;AANO,OAAlB;AASA,aAAO,YAAE,KAAF,EAAS,SAAT,EAAoB,IAApB,CAAP;AACD;;AAED,aAAS,YAAT,GAAqB;AACnB,UAAM,YAAY,GAAG,KAAK,CAAC,KAAN,CAAY,YAAY,CAAC,KAAzB,CAArB;AACA,UAAM,WAAW,GAAG,YAAY,CAAC,GAAb,CAAiB,WAAjB,CAApB;AAEA,aAAO,2BACL,WADK,EAEL,cAFK,EAGL,YAHK,CAAP;AAKD;;AAED,aAAS,QAAT,GAAiB;AACf,UAAM,SAAS,GAAG;AAChB,iBAAO;AADS,OAAlB;AAGA,aACE,CAAC,aAAa,CAAC,KAAf,IAAwB,YAAE,KAAF,EAAS,SAAT,EAAoB,YAAY,EAAhC,CAAxB,IAA+D,IADjE;AAGD;;AAED,IAAA,aAAa;AACb,IAAA,aAAa;AAEb,WAAO,YAAK;AACV,UAAM,OAAO,GAAG,kCACd,QAAQ,EADM,EAEd,UAAU,CAAC,KAFG,CAAhB;AAIA,UAAM,SAAS,GAAG;AAChB,iBAAO;AACL,qBAAW;AADN;AADS,OAAlB;AAMA,aAAO,YAAE,KAAF,EAAS,SAAT,EAAoB,OAApB,CAAP;AACD,KAZD;AAaD;AArImC,CAAhB,CAAf","sourcesContent":["// Styles\nimport './VYears.scss'\n\n// VUe API\nimport { h, ref, watchEffect, inject, computed, defineComponent } from 'vue'\n\n// Helpers\nimport { genTableRows } from './helpers'\n\n// Types\nimport { VNode, Ref } from 'vue'\nimport { DatePickerBtnHandlers } from '../../types'\n\n// Effects\nimport { useTransition } from '../../effects/use-transition'\n\nexport const VYears = defineComponent({\n  name: 'v-years',\n  props: {\n    year: [Number, String],\n  } as any,\n\n  setup(props, { emit }) {\n    const LIMIT = 100\n    const ON_TABLE = 20\n    const CELLS_IN_ROW = 4\n    const CURRENT_YEAR = new Date().getFullYear()\n    const ANIMATION_TIMEOUT = 100\n\n    const years = ref<Array<number[]>>([])\n    const onTableIndex = ref<number>(0)\n    const isListChanged = ref<boolean>(false)\n    const transition = ref<string>('')\n\n    const handlers = inject('handlers') as Ref<DatePickerBtnHandlers>\n\n    watchEffect(\n      () => isListChanged.value &&\n        setTimeout(() => {\n          isListChanged.value = false\n        }, ANIMATION_TIMEOUT),\n    )\n\n    const computedYear = computed<number>({\n      get() {\n        return +props.year! || CURRENT_YEAR\n      },\n      set(val: number) {\n        emit('update:year', val)\n      },\n    })\n\n    if (handlers?.value) {\n      handlers.value = {\n        onNext: () => changeYearsList(true),\n        onPrev: () => changeYearsList(false),\n      }\n    }\n\n    function setCurrentTransition(isNext) {\n      transition.value = isNext ? 'fade-in-down' : 'fade-in-up'\n    }\n\n    function setTableIndex() {\n      onTableIndex.value = years.value.findIndex(row => {\n        return row.find(year => year === computedYear.value)\n      })\n    }\n\n    function changeYearsList(isNext) {\n      const max = years.value.length - 1\n      const val = isNext ? 1 : -1\n\n      if (\n        (onTableIndex.value === max && val > 0) ||\n        (onTableIndex.value === 0 && val < 0)\n      ) return\n\n      setCurrentTransition(isNext)\n\n      onTableIndex.value += val\n      isListChanged.value = true\n    }\n\n    function genTableYears() {\n      const fromYear = CURRENT_YEAR - LIMIT\n      const maxYears = LIMIT * 2\n\n      let yearsList: number[] = []\n\n      for (let i = 0; i <= maxYears; i += 1) {\n        if (yearsList.length === ON_TABLE) {\n          years.value.push(yearsList)\n          yearsList = []\n        }\n        yearsList.push(fromYear + i)\n      }\n    }\n\n    function genYearCell(year): VNode {\n      const isSelected = year === computedYear.value\n      const propsData = {\n        class: {\n          'v-years__cell': true,\n          'v-years__cell--selected': isSelected,\n          'v-years__cell--current-year': year === CURRENT_YEAR,\n        },\n        onClick: () => (computedYear.value = year),\n      }\n\n      return h('div', propsData, year)\n    }\n\n    function genYearsRows(): VNode[] {\n      const currentYears = years.value[onTableIndex.value]\n      const yearsVNodes = currentYears.map(genYearCell)\n\n      return genTableRows(\n        yearsVNodes,\n        'v-years__row',\n        CELLS_IN_ROW,\n      )\n    }\n\n    function genYears(): VNode | null {\n      const propsData = {\n        class: 'v-years__years',\n      }\n      return (\n        !isListChanged.value && h('div', propsData, genYearsRows()) || null\n      )\n    }\n\n    genTableYears()\n    setTableIndex()\n\n    return () => {\n      const content = useTransition(\n        genYears() as VNode,\n        transition.value,\n      )\n      const propsData = {\n        class: {\n          'v-years': true,\n        },\n      }\n\n      return h('div', propsData, content)\n    }\n  },\n})\n"],"sourceRoot":"","file":"VYears.js"}