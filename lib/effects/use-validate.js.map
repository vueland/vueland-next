{"version":3,"sources":["../../../src/effects/use-validate.ts"],"names":[],"mappings":"AAAA,SAAS,QAAT,EAAmB,QAAnB,QAAmC,KAAnC;AAIA,OAAO,MAAM,aAAa,GAAG,MAAK;AAChC,SAAO;AACL,IAAA,KAAK,EAAE;AACL,MAAA,IAAI,EAAE,KADD;AAEL,MAAA,OAAO,EAAE;AAFJ,KADF;AAKL,IAAA,KAAK,EAAE,CAAC,MAAD,EAAS,MAAT;AALF,GAAP;AAOD,CARM;AAUP,OAAM,SAAU,WAAV,CAAsB,KAAtB,EAA2B;AAE/B,QAAM,UAAU,GAAG,QAAQ,CAAC;AAC1B,IAAA,UAAU,EAAE,IADc;AAE1B,IAAA,iBAAiB,EAAE,IAFO;AAG1B,IAAA,OAAO,EAAE;AAHiB,GAAD,CAA3B;AAMA,QAAM,QAAQ,GAAG,QAAQ,CAAC,MAAK;AAC7B,WAAO,KAAK,CAAC,KAAN,KAAgB,KAAK,CAArB,IACL,KAAK,CAAC,KAAN,KAAgB,IADX,IAEL,KAAK,CAAC,KAAN,CAAY,MAAZ,GAAqB,CAFvB;AAGD,GAJwB,CAAzB;;AAMA,QAAM,OAAO,GAAG,MAAK;AACnB,IAAA,UAAU,CAAC,OAAX,GAAqB,IAArB;AACD,GAFD;;AAIA,QAAM,QAAQ,GAAG,CAAC,GAAG,GAAG,KAAK,CAAC,KAAb,KAAsC;AACrD,QAAI,CAAC,QAAQ,CAAC,KAAd,EAAqB,OAAO,IAAP;AAErB,IAAA,OAAO;;AAEP,UAAM,MAAM,GAAG,CAAC,GAAD,EAAM,GAAG,GAAG,IAAZ,KAAoB;AACjC,UAAI,UAAU,CAAC,UAAX,KAA0B,GAA9B,EAAmC;AACjC,QAAA,UAAU,CAAC,UAAX,GAAwB,GAAxB;AACD;;AAED,UAAI,GAAG,IAAI,UAAU,CAAC,iBAAX,KAAiC,GAA5C,EAAiD;AAC/C,QAAA,UAAU,CAAC,iBAAX,GAA+B,GAA/B;AACD;AACF,KARD;;AAUA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,KAAK,CAAC,KAAN,CAAY,MAAhC,EAAwC,CAAC,IAAI,CAA7C,EAAgD;AAC9C,YAAM,IAAI,GAAG,KAAK,CAAC,KAAN,CAAY,CAAZ,CAAb;AACA,UAAI,MAAJ;;AAEA,UAAI,OAAO,IAAP,KAAgB,UAApB,EAAgC;AAC9B,QAAA,MAAM,GAAG,IAAI,CAAC,GAAD,CAAb;AACD;;AAED,UAAI,MAAM,KAAK,KAAX,IAAoB,OAAO,MAAP,KAAkB,QAA1C,EAAoD;AAClD,QAAA,MAAM,CAAC,IAAD,EAAO,MAAP,CAAN;AACA,eAAO,KAAP;AACD;;AAED,UAAI,MAAM,KAAK,IAAf,EAAqB;AACnB,QAAA,MAAM,CAAC,KAAD,CAAN;AACA,eAAO,IAAP;AACD;AACF;AACF,GAjCD;;AAmCA,SAAO;AACL,IAAA,QADK;AAEL,IAAA,OAFK;AAGL,IAAA;AAHK,GAAP;AAKD","sourcesContent":["import { reactive, computed } from 'vue'\n\n// export type Validatable = {}\n\nexport const validateProps = () => {\n  return {\n    rules: {\n      type: Array,\n      default: null\n    },\n    value: [String, Number]\n  }\n}\n\nexport function useValidate(props) {\n\n  const validState = reactive({\n    innerError: null,\n    innerErrorMessage: null,\n    isDirty: false\n  })\n\n  const hasRules = computed(() => {\n    return props.rules !== void 0 &&\n      props.rules !== null &&\n      props.rules.length > 0\n  })\n\n  const focused = () => {\n    validState.isDirty = true\n  }\n\n  const validate = (val = props.value): boolean | void => {\n    if (!hasRules.value) return true\n\n    focused()\n\n    const update = (err, msg = null) => {\n      if (validState.innerError !== err) {\n        validState.innerError = err\n      }\n\n      if (msg && validState.innerErrorMessage !== msg) {\n        validState.innerErrorMessage = msg\n      }\n    }\n    // tslint:disable-next-line:prefer-for-of\n    for (let i = 0; i < props.rules.length; i += 1) {\n      const rule = props.rules[i]\n      let result\n\n      if (typeof rule === 'function') {\n        result = rule(val)\n      }\n\n      if (result === false || typeof result === 'string') {\n        update(true, result)\n        return false\n      }\n\n      if (result === true) {\n        update(false)\n        return true\n      }\n    }\n  }\n\n  return {\n    validate,\n    focused,\n    validState,\n  }\n}\n"],"sourceRoot":"","file":"use-validate.js"}