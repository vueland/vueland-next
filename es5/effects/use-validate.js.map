{"version":3,"sources":["../../../src/effects/use-validate.ts"],"names":[],"mappings":"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","sourcesContent":["// Vue API\nimport { reactive, computed } from 'vue'\n\n// Effects\nimport { useTheme } from './use-theme'\n\nexport const validateProps = () => {\n  return {\n    rules: {\n      type: Array,\n      default: null\n    },\n    value: [ String, Number, Date, Object ]\n  }\n}\n\nexport function useValidate(props) {\n  const errorState = reactive({\n    innerError: null,\n    innerErrorMessage: null,\n    isDirty: false\n  })\n  const {\n    primary,\n    error\n  } = useTheme()\n\n  const validateClasses = computed<Record<string, boolean>>(() => {\n    return {\n      'v-validatable': true\n    }\n  })\n\n  const computedColor = computed<string | undefined>(() => {\n    if (props.disabled) return undefined\n    if (props.color) return props.color\n    return props.dark ? 'white' : primary\n  })\n\n  const validationState = computed<string | undefined>(() => {\n    if (errorState.innerError) return error\n    return computedColor.value\n  })\n\n  const hasRules = computed<boolean>(() => {\n    return (\n      props.rules !== void 0 && props.rules !== null && props.rules.length > 0\n    )\n  })\n\n  const validatable = computed<boolean>(() => {\n    return props.validate\n  })\n\n  const dirty = () => {\n    errorState.isDirty = true\n  }\n\n  const update = (err, msg = null) => {\n    if (errorState.innerError !== err) {\n      errorState.innerError = err\n    }\n\n    if (msg && errorState.innerErrorMessage !== msg) {\n      errorState.innerErrorMessage = msg\n    }\n\n    if (!msg) errorState.innerErrorMessage = msg\n\n    return errorState.innerError\n  }\n\n  const validate = (val = props.value): boolean | void => {\n    if (validatable.value) return !update(!val)\n\n    if (!hasRules.value) return true\n\n    dirty()\n\n    for (let i = 0, len = props.rules.length; i < len; i += 1) {\n      const rule = props.rules[i]\n\n      let result\n\n      if (typeof rule === 'function') {\n        result = rule(val)\n      }\n\n      if (result === false || typeof result === 'string') {\n        update(true, result)\n        return false\n      }\n\n      if (result === true && i === len - 1) {\n        update(false)\n        return true\n      }\n    }\n  }\n\n  return {\n    validate,\n    dirty,\n    update,\n    validateClasses,\n    computedColor,\n    validationState,\n    errorState\n  }\n}\n"],"sourceRoot":"","file":"use-validate.js"}