import { computed, defineComponent, h, ref } from 'vue';
import { useInputStates } from '../../composable/use-input-states';
import { getStringKeysValue } from '../../helpers';
import { VInput } from '../VInput';
import { VMenu } from '../VMenu';
import { VIcon } from '../VIcon';
import { VSelectList } from './VSelectList';
import { VProgressCircular } from '../VProgressCircular';
import { FaIcons } from '../../services/icons';
export default defineComponent({
    name: 'v-select',
    props: {
        modelValue: {
            type: [String, Number, Object],
            default: null,
        },
        items: {
            type: Array,
            default: null,
        },
        valueKey: {
            type: String,
            default: '',
        },
        activeClass: {
            type: String,
            default: 'primary white--text text--base',
        },
        loading: Boolean,
    },
    emits: ['click', 'focus', 'select', 'blur', 'change', 'update:modelValue'],
    setup(props, { attrs, emit }) {
        const { isDisabled, isReadonly, inputState, onBlur, onSelect, onFocus } = useInputStates(props, { attrs, emit });
        const activator = ref(null);
        const computedValue = computed(() => {
            if (!!props.modelValue && typeof props.modelValue === 'object') {
                return getStringKeysValue(props.valueKey, props.modelValue);
            }
            return props.modelValue;
        });
        const classes = computed(() => ({
            'v-select': true,
            'v-select--expanded': inputState.focused,
            'v-select--readonly': isReadonly.value,
            'v-select--disabled': isDisabled.value,
        }));
        const genInput = ({ textCssColor, textClassColor, disabled }) => {
            return h('input', {
                class: {
                    'v-select__input': true,
                    ...(disabled ? textClassColor : {}),
                },
                style: {
                    ...(!disabled ? textCssColor : {}),
                },
                disabled: isDisabled.value,
                type: attrs.type || 'text',
                placeholder: attrs.placeholder,
                value: computedValue.value,
                readonly: true,
            });
        };
        const genListPreloader = () => {
            return h('div', {
                class: 'v-select__preloader'
            }, h(VProgressCircular, {
                indeterminate: true,
                width: 2,
                size: 30,
                color: (attrs.color || 'primary')
            }));
        };
        const genSelectList = () => {
            return h(VMenu, {
                internalActivator: true,
                activator: activator.value,
                inputActivator: '.v-input__text-field',
                openOnClick: true,
                maxHeight: 240,
                zIndex: 12,
                onShow: onFocus,
                onHide: onBlur,
            }, {
                default: () => props.loading ? genListPreloader() : h(VSelectList, {
                    items: props.items,
                    selected: props.modelValue,
                    valueKey: props.valueKey,
                    activeClass: props.activeClass,
                    onSelect,
                }),
            });
        };
        const genExpandIcon = () => {
            return h(VIcon, {
                icon: FaIcons.$chevronDown,
                color: !isDisabled.value ? attrs.color : '',
                size: 16,
            });
        };
        const genSelect = ({ textCssColor, textClassColor, disabled }) => {
            return h('div', {
                class: classes.value,
            }, genInput({ textCssColor, textClassColor, disabled }));
        };
        return () => h(VInput, {
            ref: activator,
            value: computedValue.value,
            focused: inputState.focused,
        }, {
            ['text-field']: ({ textCssColor, textClassColor, disabled }) => {
                return genSelect({ textCssColor, textClassColor, disabled });
            },
            ['append-icon']: () => genExpandIcon(),
            select: () => activator.value ? genSelectList() : null,
        });
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVlNlbGVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1ZTZWxlY3QvVlNlbGVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLGVBQWUsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFTLE1BQU0sS0FBSyxDQUFBO0FBQzlELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQTtBQUNsRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFHbEQsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUNsQyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQ2hDLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxVQUFVLENBQUE7QUFDaEMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQTtBQUMzQyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQTtBQUd4RCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sc0JBQXNCLENBQUE7QUFHOUMsZUFBZSxlQUFlLENBQUM7SUFDN0IsSUFBSSxFQUFFLFVBQVU7SUFDaEIsS0FBSyxFQUFFO1FBQ0wsVUFBVSxFQUFFO1lBQ1YsSUFBSSxFQUFFLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUM7WUFDOUIsT0FBTyxFQUFFLElBQUk7U0FDZDtRQUNELEtBQUssRUFBRTtZQUNMLElBQUksRUFBRSxLQUFLO1lBQ1gsT0FBTyxFQUFFLElBQUk7U0FDZDtRQUNELFFBQVEsRUFBRTtZQUNSLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLEVBQUU7U0FDWjtRQUNELFdBQVcsRUFBRTtZQUNYLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLGdDQUFnQztTQUMxQztRQUNELE9BQU8sRUFBRSxPQUFPO0tBQ2pCO0lB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QUFjLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRTtnQkFDN0QsT0FBTyxTQUFTLENBQUMsRUFBRSxZQUFZLEVBQUUsY0FBYyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUE7WUFDOUQsQ0FBQztZQUNELENBQUMsYUFBYSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsYUFBYSxFQUFFO1lBQ3RDLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFBLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSTtTQUN0RCxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29tcHV0ZWQsIGRlZmluZUNvbXBvbmVudCwgaCwgcmVmLCBWTm9kZSB9IGZyb20gJ3Z1ZSdcbmltcG9ydCB7IHVzZUlucHV0U3RhdGVzIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZS91c2UtaW5wdXQtc3RhdGVzJ1xuaW1wb3J0IHsgZ2V0U3RyaW5nS2V5c1ZhbHVlIH0gZnJvbSAnLi4vLi4vaGVscGVycydcblxuLy8gQ29tcG9uZW50c1xuaW1wb3J0IHsgVklucHV0IH0gZnJvbSAnLi4vVklucHV0J1xuaW1wb3J0IHsgVk1lbnUgfSBmcm9tICcuLi9WTWVudSdcbmltcG9ydCB7IFZJY29uIH0gZnJvbSAnLi4vVkljb24nXG5pbXBvcnQgeyBWU2VsZWN0TGlzdCB9IGZyb20gJy4vVlNlbGVjdExpc3QnXG5pbXBvcnQgeyBWUHJvZ3Jlc3NDaXJjdWxhciB9IGZyb20gJy4uL1ZQcm9ncmVzc0NpcmN1bGFyJ1xuXG4vLyBTZXJ2aWNlc1xuaW1wb3J0IHsgRmFJY29ucyB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2ljb25zJ1xuaW1wb3J0IHsgTWF5YmUgfSBmcm9tICcuLi8uLi8uLi90eXBlcy9iYXNlJ1xuXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBuYW1lOiAndi1zZWxlY3QnLFxuICBwcm9wczoge1xuICAgIG1vZGVsVmFsdWU6IHtcbiAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlciwgT2JqZWN0XSxcbiAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgfSxcbiAgICBpdGVtczoge1xuICAgICAgdHlwZTogQXJyYXksXG4gICAgICBkZWZhdWx0OiBudWxsLFxuICAgIH0sXG4gICAgdmFsdWVLZXk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICcnLFxuICAgIH0sXG4gICAgYWN0aXZlQ2xhc3M6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICdwcmltYXJ5IHdoaXRlLS10ZXh0IHRleHQtLWJhc2UnLFxuICAgIH0sXG4gICAgbG9hZGluZzogQm9vbGVhbixcbiAgfSxcbiAgZW1pdHM6IFsnY2xpY2snLCAnZm9jdXMnLCAnc2VsZWN0JywgJ2JsdXInLCAnY2hhbmdlJywgJ3VwZGF0ZTptb2RlbFZhbHVlJ10sXG4gIHNldHVwKHByb3BzLCB7IGF0dHJzLCBlbWl0IH0pIHtcbiAgICBjb25zdCB7IGlzRGlzYWJsZWQsIGlzUmVhZG9ubHksIGlucHV0U3RhdGUsIG9uQmx1ciwgb25TZWxlY3QsIG9uRm9jdXMgfSA9XG4gICAgICB1c2VJbnB1dFN0YXRlcyhwcm9wcywgeyBhdHRycywgZW1pdCB9KVxuXG4gICAgY29uc3QgYWN0aXZhdG9yID0gcmVmPE1heWJlPEhUTUxFbGVtZW50Pj4obnVsbClcblxuICAgIGNvbnN0IGNvbXB1dGVkVmFsdWUgPSBjb21wdXRlZDxzdHJpbmcgfCBudW1iZXI+KCgpID0+IHtcbiAgICAgIGlmICghIXByb3BzLm1vZGVsVmFsdWUgJiYgdHlwZW9mIHByb3BzLm1vZGVsVmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBnZXRTdHJpbmdLZXlzVmFsdWUocHJvcHMudmFsdWVLZXksIHByb3BzLm1vZGVsVmFsdWUpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwcm9wcy5tb2RlbFZhbHVlXG4gICAgfSlcblxuICAgIGNvbnN0IGNsYXNzZXMgPSBjb21wdXRlZDxSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj4oKCkgPT4gKHtcbiAgICAgICd2LXNlbGVjdCc6IHRydWUsXG4gICAgICAndi1zZWxlY3QtLWV4cGFuZGVkJzogaW5wdXRTdGF0ZS5mb2N1c2VkLFxuICAgICAgJ3Ytc2VsZWN0LS1yZWFkb25seSc6IGlzUmVhZG9ubHkudmFsdWUsXG4gICAgICAndi1zZWxlY3QtLWRpc2FibGVkJzogaXNEaXNhYmxlZC52YWx1ZSxcbiAgICB9KSlcblxuICAgIGNvbnN0IGdlbklucHV0ID0gKHsgdGV4dENzc0NvbG9yLCB0ZXh0Q2xhc3NDb2xvciwgZGlzYWJsZWQgfSkgPT4ge1xuICAgICAgcmV0dXJuIGgoJ2lucHV0Jywge1xuICAgICAgICBjbGFzczoge1xuICAgICAgICAgICd2LXNlbGVjdF9faW5wdXQnOiB0cnVlLFxuICAgICAgICAgIC4uLihkaXNhYmxlZCA/IHRleHRDbGFzc0NvbG9yIDoge30pLFxuICAgICAgICB9LFxuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIC4uLighZGlzYWJsZWQgPyB0ZXh0Q3NzQ29sb3IgOiB7fSksXG4gICAgICAgIH0sXG4gICAgICAgIGRpc2FibGVkOiBpc0Rpc2FibGVkLnZhbHVlLFxuICAgICAgICB0eXBlOiBhdHRycy50eXBlIHx8ICd0ZXh0JyxcbiAgICAgICAgcGxhY2Vob2xkZXI6IGF0dHJzLnBsYWNlaG9sZGVyLFxuICAgICAgICB2YWx1ZTogY29tcHV0ZWRWYWx1ZS52YWx1ZSxcbiAgICAgICAgcmVhZG9ubHk6IHRydWUsXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IGdlbkxpc3RQcmVsb2FkZXIgPSAoKSA9PiB7XG4gICAgICByZXR1cm4gaCgnZGl2Jywge1xuICAgICAgICBjbGFzczogJ3Ytc2VsZWN0X19wcmVsb2FkZXInXG4gICAgICB9LCBoKFZQcm9ncmVzc0NpcmN1bGFyLCB7XG4gICAgICAgIGluZGV0ZXJtaW5hdGU6IHRydWUsXG4gICAgICAgIHdpZHRoOiAyLFxuICAgICAgICBzaXplOiAzMCxcbiAgICAgICAgY29sb3I6IChhdHRycy5jb2xvciB8fCAncHJpbWFyeScpIGFzIHN0cmluZ1xuICAgICAgfSkpXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuU2VsZWN0TGlzdCA9ICgpOiBWTm9kZSA9PiB7XG4gICAgICByZXR1cm4gaChWTWVudSwge1xuICAgICAgICBpbnRlcm5hbEFjdGl2YXRvcjogdHJ1ZSxcbiAgICAgICAgYWN0aXZhdG9yOiBhY3RpdmF0b3IudmFsdWUhLFxuICAgICAgICBpbnB1dEFjdGl2YXRvcjogJy52LWlucHV0X190ZXh0LWZpZWxkJyxcbiAgICAgICAgb3Blbk9uQ2xpY2s6IHRydWUsXG4gICAgICAgIG1heEhlaWdodDogMjQwLFxuICAgICAgICB6SW5kZXg6IDEyLFxuICAgICAgICBvblNob3c6IG9uRm9jdXMsXG4gICAgICAgIG9uSGlkZTogb25CbHVyLFxuICAgICAgfSwge1xuICAgICAgICBkZWZhdWx0OiAoKSA9PiBwcm9wcy5sb2FkaW5nID8gZ2VuTGlzdFByZWxvYWRlcigpIDogaChWU2VsZWN0TGlzdCwge1xuICAgICAgICAgIGl0ZW1zOiBwcm9wcy5pdGVtcyxcbiAgICAgICAgICBzZWxlY3RlZDogcHJvcHMubW9kZWxWYWx1ZSxcbiAgICAgICAgICB2YWx1ZUtleTogcHJvcHMudmFsdWVLZXksXG4gICAgICAgICAgYWN0aXZlQ2xhc3M6IHByb3BzLmFjdGl2ZUNsYXNzLFxuICAgICAgICAgIG9uU2VsZWN0LFxuICAgICAgICB9KSxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuRXhwYW5kSWNvbiA9ICgpOiBWTm9kZSA9PiB7XG4gICAgICByZXR1cm4gaChWSWNvbiwge1xuICAgICAgICBpY29uOiBGYUljb25zLiRjaGV2cm9uRG93bixcbiAgICAgICAgY29sb3I6ICFpc0Rpc2FibGVkLnZhbHVlID8gYXR0cnMuY29sb3IgOiAnJyxcbiAgICAgICAgc2l6ZTogMTYsXG4gICAgICB9KVxuICAgIH1cblxuICAgIGNvbnN0IGdlblNlbGVjdCA9ICh7IHRleHRDc3NDb2xvciwgdGV4dENsYXNzQ29sb3IsIGRpc2FibGVkIH0pID0+IHtcbiAgICAgIHJldHVybiBoKCdkaXYnLCB7XG4gICAgICAgIGNsYXNzOiBjbGFzc2VzLnZhbHVlLFxuICAgICAgfSwgZ2VuSW5wdXQoeyB0ZXh0Q3NzQ29sb3IsIHRleHRDbGFzc0NvbG9yLCBkaXNhYmxlZCB9KSlcbiAgICB9XG5cbiAgICByZXR1cm4gKCkgPT4gaChWSW5wdXQsIHtcbiAgICAgIHJlZjogYWN0aXZhdG9yLFxuICAgICAgdmFsdWU6IGNvbXB1dGVkVmFsdWUudmFsdWUsXG4gICAgICBmb2N1c2VkOiBpbnB1dFN0YXRlLmZvY3VzZWQsXG4gICAgfSwge1xuICAgICAgWyd0ZXh0LWZpZWxkJ106ICh7IHRleHRDc3NDb2xvciwgdGV4dENsYXNzQ29sb3IsIGRpc2FibGVkIH0pID0+IHtcbiAgICAgICAgcmV0dXJuIGdlblNlbGVjdCh7IHRleHRDc3NDb2xvciwgdGV4dENsYXNzQ29sb3IsIGRpc2FibGVkIH0pXG4gICAgICB9LFxuICAgICAgWydhcHBlbmQtaWNvbiddOiAoKSA9PiBnZW5FeHBhbmRJY29uKCksXG4gICAgICBzZWxlY3Q6ICgpID0+IGFjdGl2YXRvci52YWx1ZT8gZ2VuU2VsZWN0TGlzdCgpIDogbnVsbCxcbiAgICB9KVxuICB9LFxufSlcbiJdfQ==