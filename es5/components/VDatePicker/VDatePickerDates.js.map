{"version":3,"sources":["../../../../src/components/VDatePicker/VDatePickerDates.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VDatePickerDates.scss'\n\n// Vue API\nimport { h, ref, inject, computed, watch, defineComponent } from 'vue'\n\n// Helpers\nimport { genTableRows, parseDate, toDateString } from './helpers'\n\n// Effects\nimport { useTransition } from '../../effects/use-transition'\n\n// Types\nimport { VNode, Ref } from 'vue'\nimport { DatePickerBtnHandlers, DatePickerDate } from '../../types'\n\ntype UpdateParams = {\n  month?: number\n  year?: number\n}\n\nexport const VDatePickerDates = defineComponent({\n  name: 'v-date-picker-dates',\n\n  props: {\n    locale: Array,\n    year: [String, Number],\n    month: [String, Number],\n    date: [String, Number],\n    value: Object,\n    mondayFirst: Boolean,\n    disabledDates: Object,\n  } as any,\n\n  emits: ['update:month', 'update:value'],\n\n  setup(props, { emit, slots }): () => VNode {\n    const FIRST_MONTH = 0\n    const LAST_MONTH = 11\n    const DAYS = [0, 1, 2, 3, 4, 5, 6]\n    const ANIMATION_TIMEOUT = 0\n\n    const dates = ref<(DatePickerDate | null)[]>([])\n    const isDatesChanged = ref<boolean>(false)\n    const today = parseDate(new Date())\n\n    const handlers = inject('handlers') as Ref<DatePickerBtnHandlers>\n\n    handlers.value = {\n      onNext: () => updateMonth(true),\n      onPrev: () => updateMonth(false),\n    }\n\n    if (props.mondayFirst) {\n      DAYS.push(DAYS.splice(0, 1)[0])\n    }\n\n    const daysInMonth = computed<number>(() => {\n      return new Date(props.year, props.month + 1, 0).getDate()\n    })\n\n    watch(\n      () => props.month,\n      () => genTableDates(),\n      { immediate: true }\n    )\n\n    watch(\n      () => isDatesChanged.value,\n      () => setTimeout(() => (isDatesChanged.value = false), ANIMATION_TIMEOUT)\n    )\n\n    function updateMonth(isNext: boolean) {\n      const params: UpdateParams = {}\n\n      params.month = props.month + (isNext ? 1 : -1)\n\n      if (!isNext && params.month! < FIRST_MONTH) params.month = LAST_MONTH\n      if (isNext && params.month! > LAST_MONTH) params.month = FIRST_MONTH\n      if (isNext && !params.month) params.year = props.year + 1\n      if (!isNext && params.month === LAST_MONTH) params.year = props.year - 1\n\n      isDatesChanged.value = true\n      emit('update:month', params)\n    }\n\n    function genWeekDays(): VNode[] {\n      const propsData = {\n        class: 'v-date-picker-dates__day',\n      }\n\n      return DAYS.map((day) =>\n        h('span', propsData, props.locale![day] as string)\n      )\n    }\n\n    function genDateObject(date): DatePickerDate {\n      const { year, month } = props\n      return parseDate(new Date(year, month, date))\n    }\n\n    function setEmptiesBeforeFirstDate(dateObject) {\n      const firstDay = DAYS[0]\n\n      const startDay = firstDay && !dateObject.day ? dateObject.day : firstDay\n\n      const tillDay =\n        firstDay && !dateObject.day ? DAYS.length - 1 : dateObject.day\n\n      for (let i = startDay; i <= tillDay; i += 1) {\n        dates.value[i] = { date: null } as any\n      }\n\n      dates.value[tillDay] = dateObject\n    }\n\n    function genTableDates() {\n      dates.value = []\n      for (let i = 1; i <= daysInMonth.value; i += 1) {\n        const dateObject = genDateObject(i)\n\n        if (i === 1) {\n          setEmptiesBeforeFirstDate(dateObject)\n        } else {\n          dates.value[dates.value.length] = dateObject as any\n        }\n      }\n    }\n\n    function compareDates(date1, date2) {\n      return (\n        date1.date === date2.date &&\n        date1.month === date2.month &&\n        date1.year === date2.year\n      )\n    }\n\n    function setDisabled(date: DatePickerDate): boolean {\n      if (!date.date) return false\n      if (!props.disabledDates) return !!date.isHoliday\n      const { disabledDates } = props\n\n      return (\n        (disabledDates.daysOfMonth && disableDaysOfMonth(date)) ||\n        (disabledDates.from && disableFromTo(date, disabledDates)) ||\n        (disabledDates.dates && disableDates(date)) ||\n        (disabledDates.days && disableDays(date)) ||\n        (disabledDates.ranges && disableRanges(date)) ||\n        (disabledDates.custom && disabledDates.custom(date))\n      )\n    }\n\n    function disableFromTo(date: DatePickerDate, { from, to }): boolean {\n      const dateFrom: DatePickerDate = parseDate(from)\n      const dateTo: DatePickerDate = parseDate(to)\n\n      return date.mls >= dateFrom.mls && date.mls <= dateTo.mls\n    }\n\n    function disableDaysOfMonth(date: DatePickerDate) {\n      return !!props.disabledDates.daysOfMonth.find((it) => it === date.date)\n    }\n\n    function disableDates(date: DatePickerDate): boolean {\n      return props.disabledDates.dates.find((d) => {\n        return String(d) === String(toDateString(date))\n      })\n    }\n\n    function disableDays(date: DatePickerDate): boolean {\n      return props.disabledDates.days.find((d) => d === date.day) >= 0\n    }\n\n    function disableRanges(date: DatePickerDate) {\n      const { ranges } = props.disabledDates\n\n      for (let i = 0; i < ranges.length; i += 1) {\n        if (disableFromTo(date, ranges[i])) return true\n      }\n    }\n\n    function genDateCell(date: DatePickerDate): VNode {\n      const isSelected: boolean = compareDates(date, props.value)\n      const isToday: boolean = compareDates(date, today)\n\n      date.isHoliday = setDisabled(date)\n\n      const propsData = {\n        class: {\n          'v-date-picker-dates__cell': !!date.date,\n          'v-date-picker-dates__cell--empty': !date.date,\n          'v-date-picker-dates__cell--selected': isSelected,\n          'v-date-picker-dates__cell--current-date': isToday,\n          'v-date-picker-dates__cell--holiday': date.date && date.isHoliday,\n        },\n        onClick: () => date.date && emit('update:value', date),\n      }\n\n      return h('div', propsData, [\n        (date.date && slots.date && slots.date(date)) || date.date,\n      ])\n    }\n\n    function genDateCells(): VNode[] {\n      return dates.value.reduce((acc, dateObject) => {\n        acc.push(genDateCell(dateObject!))\n        return acc\n      }, [] as VNode[])\n    }\n\n    function genDateRows(): VNode[] {\n      const datesVNodes = genDateCells()\n\n      return genTableRows(datesVNodes, 'v-date-picker-dates__row', DAYS.length)\n    }\n\n    function genDates(): VNode | null {\n      return (\n        (!isDatesChanged.value &&\n          h('div', { class: 'v-date-picker-dates__dates' }, genDateRows())) ||\n        null\n      )\n    }\n\n    function genWeek(): VNode {\n      return h('div', { class: 'v-date-picker-dates__week' }, genWeekDays())\n    }\n\n    return () =>\n      h('div', { class: 'v-date-picker-dates' }, [\n        genWeek(),\n        useTransition(genDates() as any, 'fade'),\n      ])\n  },\n})\n"],"sourceRoot":"","file":"VDatePickerDates.js"}