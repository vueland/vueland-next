{"version":3,"sources":["../../../../src/components/VSelect/VSelect.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VSelect.scss'\n\n// Vue API\nimport { h, ref, reactive, computed, defineComponent, watch } from 'vue'\n\n// Effects\nimport { colorProps, useColors } from '../../effects/use-colors'\nimport { useTheme } from '../../effects/use-theme'\nimport { activatorProps } from '../../effects/use-activator'\nimport { validateProps } from '../../effects/use-validate'\n\n// Types\nimport { VNode } from 'vue'\n\n// Components\nimport { VInput } from '../VInput'\nimport { VSelectList } from './VSelectList'\nimport { VMenu } from '../VMenu'\n\n// Helpers\nimport { getKeyValueFromTarget } from '../../helpers'\n\ntype SelectState = {\n  selected: any | null\n  focused: boolean\n}\n\nexport const VSelect = defineComponent({\n  name: 'v-select',\n\n  props: {\n    label: String,\n    items: Array,\n    dark: Boolean,\n    valueKey: String,\n    idKey: String,\n    listColor: String,\n    disabled: Boolean,\n    readonly: Boolean,\n    clearable: Boolean,\n    modelValue: {\n      default: null\n    },\n    ...colorProps(),\n    ...activatorProps(),\n    ...validateProps()\n  } as any,\n\n  emits: [\n    'input',\n    'blur',\n    'focus',\n    'select',\n    'update:modelValue',\n    'update:value'\n  ],\n\n  setup(props, { emit, attrs }): () => VNode {\n    const state: SelectState = reactive({\n      selected: null,\n      focused: false\n    })\n\n    const { setTextColor } = useColors()\n    const { base } = useTheme()\n\n    const inputRef = ref<HTMLElement | null>(null)\n\n    const classes = computed<Record<string, boolean>>(() => ({\n      'v-select': true,\n      'v-select--disabled': props.disabled,\n      'v-select--readonly': props.readonly,\n      'v-select--focused': state.focused\n    }))\n\n    const computedInputValue = computed<string>(() => {\n      return state.selected\n        ? props.valueKey\n          ? getKeyValueFromTarget(props.valueKey, state.selected)\n          : state.selected\n        : ''\n    })\n\n    const computedValue = computed<any>(() => {\n      return props.modelValue || props.value\n    })\n\n    watch(\n      () => computedValue.value,\n      (to) => state.selected = to,\n      { immediate: true }\n    )\n\n    function toggleState() {\n      state.focused = !state.focused\n    }\n\n    function onBlur() {\n      setTimeout(() => {\n        toggleState()\n        emit('blur')\n      })\n    }\n\n    function onClick() {\n      toggleState()\n      emit('focus')\n    }\n\n    function onClear() {\n      state.selected = ''\n    }\n\n    function selectItem(item) {\n      state.selected = item\n      emit('select', item)\n      emit('update:value', item)\n      emit('update:modelValue', item)\n    }\n\n    function genInput(): VNode {\n      const propsData = {\n        value: computedInputValue.value,\n        disabled: props.disabled,\n        readonly: props.readonly && !props.typeable,\n        class: 'v-select__input',\n        ref: inputRef,\n        onClick\n      }\n      return h('input', setTextColor(props.dark ? 'white' : base, propsData))\n    }\n\n    function genSelectList(): VNode {\n      const propsData = {\n        items: props.items,\n        valueKey: props.valueKey,\n        idKey: props.idKey,\n        active: state.focused,\n        color: props.dark ? 'white' : props.color,\n        listColor: props.listColor || 'white',\n        select: state.selected,\n        dark: props.dark,\n        onSelect: (item) => selectItem(item)\n      }\n      return h(VSelectList, propsData)\n    }\n\n    function genMenu() {\n      return h(\n        VMenu,\n        {\n          activator: inputRef!,\n          openOnClick: true,\n          maxHeight: 240,\n          onClose: onBlur\n        },\n        {\n          default: () => genSelectList()\n        }\n      )\n    }\n\n    function genSelect(): VNode {\n      const propsData = {\n        class: classes.value\n      }\n\n      return h('div', propsData, [ genInput(), genMenu() ])\n    }\n\n    return () => {\n      const propsData = {\n        label: props.label,\n        focused: state.focused,\n        hasState: !!computedInputValue.value,\n        dark: props.dark,\n        disabled: props.disabled,\n        clearable: props.clearable,\n        value: computedInputValue.value,\n        color: props.color,\n        rules: props.rules,\n        onClear,\n        ...attrs\n      } as any\n\n      return h(VInput, propsData, { textField: () => genSelect() })\n    }\n  }\n})\n"],"sourceRoot":"","file":"VSelect.js"}