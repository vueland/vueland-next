{"version":3,"sources":["../../../../src/components/VDatePicker/VDatePickerDates.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VDatePickerDates.scss'\n\n// Vue API\nimport { h, ref, inject, computed, watch, defineComponent } from 'vue'\n\n// Helpers\nimport { genTableRows, parseDate } from './helpers'\n\n// Effects\nimport { useTransition } from '../../effects/use-transition'\n\n// Types\nimport { VNode, Ref } from 'vue'\nimport { DatePickerBtnHandlers, DatePickerDate } from '../../types'\n\ntype UpdateParams = {\n  month?: number\n  year?: number\n}\n\nexport const VDatePickerDates = defineComponent({\n  name: 'v-date-picker-dates',\n\n  props: {\n    localeWeek: Array,\n    year: [String, Number],\n    month: [String, Number],\n    date: [String, Number],\n    value: Object,\n    mondayFirst: Boolean,\n  } as any,\n\n  setup(props, { emit }): () => VNode {\n    const FIRST_MONTH = 0\n    const LAST_MONTH = 11\n    const WEEK = [0, 1, 2, 3, 4, 5, 6]\n    const ANIMATION_TIMEOUT = 100\n    const TODAY = parseDate(new Date())\n\n    const dates = ref<(Date | null)[]>([])\n    const isDatesChanged = ref<boolean>(false)\n\n    const handlers = inject('handlers') as Ref<DatePickerBtnHandlers>\n\n    handlers.value = {\n      onNext: () => updateMonth(true),\n      onPrev: () => updateMonth(false),\n    }\n\n    if (props.mondayFirst) {\n      WEEK.push(WEEK.splice(0, 1)[0])\n    }\n\n    const daysInMonth = computed<number>(() => {\n      return new Date(props.year, props.month + 1, 0).getDate()\n    })\n\n    watch(\n      () => props.month,\n      () => genTableDates(),\n      { immediate: true },\n    )\n\n    watch(\n      () => isDatesChanged.value,\n      () => setTimeout(() => {\n        isDatesChanged.value = false\n      }, ANIMATION_TIMEOUT),\n    )\n\n\n    function updateMonth(isNext: boolean) {\n      const params: UpdateParams = {}\n\n      params.month = props.month + (isNext ? 1 : -1)\n\n      if (!isNext && params.month! < FIRST_MONTH) params.month = LAST_MONTH\n      if (isNext && params.month! > LAST_MONTH) params.month = FIRST_MONTH\n      if (isNext && !params.month) params.year = props.year + 1\n      if (!isNext && params.month === LAST_MONTH) params.year = props.year - 1\n\n      isDatesChanged.value = true\n      emit('update:month', params)\n    }\n\n    function genWeekDays(): VNode[] {\n      const propsData = {\n        class: {\n          'v-date-picker-dates__day': true,\n        },\n      }\n\n      return WEEK.map(day => {\n        return h('span', propsData, props.localeWeek![day] as string)\n      })\n    }\n\n    function genDateObject(date): DatePickerDate {\n      const { year, month } = props\n      return parseDate(new Date(year, month, date))\n    }\n\n    function setEmptiesBeforeFirstDate(dateObject) {\n      const firstDay = WEEK[0]\n\n      const startDay = firstDay && !dateObject.day ?\n        dateObject.day : firstDay\n\n      const tillDay = firstDay && !dateObject.day ?\n        WEEK.length - 1 : dateObject.day\n\n      for (let i = startDay; i <= tillDay; i += 1) {\n        dates.value[i] = { date: null } as any\n      }\n\n      dates.value[tillDay] = dateObject\n    }\n\n    function genTableDates() {\n      dates.value = []\n\n      for (let i = 1; i <= daysInMonth.value; i += 1) {\n        const dateObject = genDateObject(i)\n\n        if (i === 1) {\n          setEmptiesBeforeFirstDate(dateObject)\n        } else {\n          dates.value[dates.value.length] = dateObject as any\n        }\n      }\n    }\n\n    function compareDates(date1, date2) {\n      return (\n        date1.date === date2.date &&\n        date1.month === date2.month &&\n        date1.year === date2.year\n      )\n    }\n\n    function genDateCell(obj): VNode {\n      const propsData = {\n        class: {\n          'v-date-picker-dates__cell': !!obj.date,\n          'v-date-picker-dates__cell--empty': !obj.date,\n          'v-date-picker-dates__cell--selected': compareDates(obj, props.value),\n          'v-date-picker-dates__cell--current-date': compareDates(obj, TODAY),\n          'v-date-picker-dates__cell--holiday': obj.isHoliday,\n        },\n        onClick: () => emit('update:value', obj),\n      }\n\n      return h('div', propsData, obj.date)\n    }\n\n    function genDateCells(): VNode[] {\n      return dates.value.reduce((acc, dateObject) => {\n        acc.push(genDateCell(dateObject))\n        return acc\n      }, [] as any)\n    }\n\n    function genDateRows(): VNode[] {\n      const datesVNodes = genDateCells()\n      return genTableRows(datesVNodes, 'v-date-picker-dates__row', WEEK.length)\n    }\n\n    function genDates(): VNode | null {\n      return (\n        (!isDatesChanged.value &&\n          h('div', { class: 'v-date-picker-dates__dates' }, genDateRows())) || null\n      )\n    }\n\n    function genWeek(): VNode {\n      return h('div', { class: 'v-date-picker-dates__week' }, genWeekDays())\n    }\n\n    return () => h('div', { class: 'v-date-picker-dates' }, [\n      genWeek(),\n      useTransition(genDates() as any, 'fade'),\n    ])\n  },\n})\n"],"sourceRoot":"","file":"VDatePickerDates.js"}