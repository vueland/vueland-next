import './VBadge.scss';
import { vShow, h, computed, withDirectives, defineComponent } from 'vue';
import { positionProps } from '../../effects/use-position';
import { useColors } from '../../effects/use-colors';
import { useToggle } from '../../effects/use-toggle';
import { useElevation, elevationProps } from '../../effects/use-elevation';
import { useTransition } from '../../effects/use-transition';
export const VBadge = defineComponent({
    name: 'v-badge',
    props: {
        dot: Boolean,
        avatar: Boolean,
        border: Boolean,
        toggle: Boolean,
        content: {
            required: false,
        },
        color: {
            type: String,
            default: 'primary',
        },
        transition: {
            type: String,
            default: 'scaleIn',
        },
        ...positionProps(),
        ...elevationProps(),
    },
    setup(props, { slots }) {
        const { elevationClasses } = useElevation(props);
        const { setBackground } = useColors();
        const offset = computed(() => {
            return props.dot ? 4 : 12;
        });
        const calcPosition = (offsetVal = 0) => {
            const value = -offset.value - Number(offsetVal);
            return `${value}px`;
        };
        const computedLeft = computed(() => {
            return props.left && calcPosition(props.offsetX);
        });
        const computedRight = computed(() => {
            return props.right && calcPosition(props.offsetX);
        });
        const computedTop = computed(() => {
            return props.top && calcPosition(props.offsetY);
        });
        const computedBottom = computed(() => {
            return props.bottom && calcPosition(props.offsetY);
        });
        const classes = computed(() => ({
            'v-badge': true,
            'v-badge--border': props.border,
            'v-badge--dot': props.dot,
            'v-badge--avatar': props.avatar,
        }));
        const badgeClasses = computed(() => {
            return {
                'v-badge__badge': true,
                ...elevationClasses.value,
            };
        });
        const styles = computed(() => {
            return {
                top: computedTop.value,
                right: computedRight.value,
                bottom: computedBottom.value,
                left: computedLeft.value,
            };
        });
        function addContent() {
            if (props.dot)
                return undefined;
            if (props.content)
                return String(props.content);
            return undefined;
        }
        function genBadgeSlot() {
            const propsData = {
                class: {
                    'v-badge__badge-slot': true,
                },
            };
            return slots.badge ? h('div', propsData, slots.badge()) : null;
        }
        function genContent() {
            const propsData = {
                class: {
                    'v-badge__content': true,
                },
            };
            return h('div', propsData, [addContent(), genBadgeSlot()]);
        }
        function genBadge() {
            const propsData = setBackground(props.color, {
                class: badgeClasses.value,
                style: styles.value,
            });
            return h('div', propsData, genContent());
        }
        return () => {
            let badge = genBadge();
            if (props.toggle && !slots.badge) {
                const { isActive } = useToggle(props, 'content');
                badge = withDirectives(badge, [[vShow, isActive.value]]);
            }
            const propsData = {
                class: classes.value,
            };
            const children = [
                useTransition(badge, props.transition),
                slots.default && slots.default(),
            ];
            return h('div', propsData, children);
        };
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkJhZGdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVkJhZGdlL1ZCYWRnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLGVBQWUsQ0FBQTtBQUd0QixPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLEtBQUssQ0FBQTtBQUd6RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUE7QUFDMUQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFBO0FBQ3BELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQTtBQUNwRCxPQUFPLEVBQUUsWUFBWSxFQUFFLGNBQWMsRUFBRSxNQUFNLDZCQUE2QixDQUFBO0FBQzFFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQTtBQUs1RCxNQUFNLENBQUMsTUFBTSxNQUFNLEdBQUcsZUFBZSxDQUFDO0lBQ3BDLElBQUksRUFBRSxTQUFTO0lBRWYsS0FBSyxFQUFFO1FBQ0wsR0FBRyxFQUFFLE9BQU87UUFDWixNQUFNLEVBQUUsT0FBTztRQUNmLE1BQU0sRUFBRSxPQUFPO1FBQ2YsTUFBTSxFQUFFLE9BQU87UUFDZixPQUFPLEVBQUU7WUFDUCxRQUFRLEVBQUUsS0FBSztTQUNoQjtRQUNELEtBQUssRUFBRTtZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLFNBQVM7U0FDbkI7UUFDRCxVQUFVLEVBQUU7WUFDVixJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxTQUFTO1NBQ25CO1FBQ0QsR0FBRyxhQUFhLEVBQUU7UUFDbEIsR0FBRyxjQUFjLEVBQUU7S0FDYjtJQUVSLEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxLQUFLLEVBQUU7UUFDcEIsTUFBTSxFQUFFLGdCQUFnQixFQUFFLEdBQUcsWUFBWSxD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QVMsRUFBRSxRQUFRLENBQUMsQ0FBQTtRQUN0QyxDQUFDLENBQUE7SUFDSCxDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL1ZCYWRnZS5zY3NzJ1xuXG4vLyBWdWUgQVBJXG5pbXBvcnQgeyB2U2hvdywgaCwgY29tcHV0ZWQsIHdpdGhEaXJlY3RpdmVzLCBkZWZpbmVDb21wb25lbnQgfSBmcm9tICd2dWUnXG5cbi8vIEVmZmVjdHNcbmltcG9ydCB7IHBvc2l0aW9uUHJvcHMgfSBmcm9tICcuLi8uLi9lZmZlY3RzL3VzZS1wb3NpdGlvbidcbmltcG9ydCB7IHVzZUNvbG9ycyB9IGZyb20gJy4uLy4uL2VmZmVjdHMvdXNlLWNvbG9ycydcbmltcG9ydCB7IHVzZVRvZ2dsZSB9IGZyb20gJy4uLy4uL2VmZmVjdHMvdXNlLXRvZ2dsZSdcbmltcG9ydCB7IHVzZUVsZXZhdGlvbiwgZWxldmF0aW9uUHJvcHMgfSBmcm9tICcuLi8uLi9lZmZlY3RzL3VzZS1lbGV2YXRpb24nXG5pbXBvcnQgeyB1c2VUcmFuc2l0aW9uIH0gZnJvbSAnLi4vLi4vZWZmZWN0cy91c2UtdHJhbnNpdGlvbidcblxuLy8gVHlwZXNcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAndnVlJ1xuXG5leHBvcnQgY29uc3QgVkJhZGdlID0gZGVmaW5lQ29tcG9uZW50KHtcbiAgbmFtZTogJ3YtYmFkZ2UnLFxuXG4gIHByb3BzOiB7XG4gICAgZG90OiBCb29sZWFuLFxuICAgIGF2YXRhcjogQm9vbGVhbixcbiAgICBib3JkZXI6IEJvb2xlYW4sXG4gICAgdG9nZ2xlOiBCb29sZWFuLFxuICAgIGNvbnRlbnQ6IHtcbiAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICB9LFxuICAgIGNvbG9yOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAncHJpbWFyeScsXG4gICAgfSxcbiAgICB0cmFuc2l0aW9uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiAnc2NhbGVJbicsXG4gICAgfSxcbiAgICAuLi5wb3NpdGlvblByb3BzKCksXG4gICAgLi4uZWxldmF0aW9uUHJvcHMoKSxcbiAgfSBhcyBhbnksXG5cbiAgc2V0dXAocHJvcHMsIHsgc2xvdHMgfSk6ICgpID0+IFZOb2RlIHtcbiAgICBjb25zdCB7IGVsZXZhdGlvbkNsYXNzZXMgfSA9IHVzZUVsZXZhdGlvbihwcm9wcylcbiAgICBjb25zdCB7IHNldEJhY2tncm91bmQgfSA9IHVzZUNvbG9ycygpXG5cbiAgICBjb25zdCBvZmZzZXQgPSBjb21wdXRlZDxudW1iZXI+KCgpID0+IHtcbiAgICAgIHJldHVybiBwcm9wcy5kb3QgPyA0IDogMTJcbiAgICB9KVxuXG4gICAgY29uc3QgY2FsY1Bvc2l0aW9uID0gKG9mZnNldFZhbDogc3RyaW5nIHwgbnVtYmVyID0gMCk6IHN0cmluZyA9PiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IC1vZmZzZXQudmFsdWUgLSBOdW1iZXIob2Zmc2V0VmFsKVxuICAgICAgcmV0dXJuIGAkeyB2YWx1ZSB9cHhgXG4gICAgfVxuXG4gICAgY29uc3QgY29tcHV0ZWRMZWZ0ID0gY29tcHV0ZWQ8c3RyaW5nIHwgYm9vbGVhbj4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHByb3BzLmxlZnQgJiYgY2FsY1Bvc2l0aW9uKHByb3BzLm9mZnNldFgpXG4gICAgfSlcblxuICAgIGNvbnN0IGNvbXB1dGVkUmlnaHQgPSBjb21wdXRlZDxzdHJpbmcgfCBib29sZWFuPigoKSA9PiB7XG4gICAgICByZXR1cm4gcHJvcHMucmlnaHQgJiYgY2FsY1Bvc2l0aW9uKHByb3BzLm9mZnNldFgpXG4gICAgfSlcblxuICAgIGNvbnN0IGNvbXB1dGVkVG9wID0gY29tcHV0ZWQ8c3RyaW5nIHwgYm9vbGVhbj4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHByb3BzLnRvcCAmJiBjYWxjUG9zaXRpb24ocHJvcHMub2Zmc2V0WSlcbiAgICB9KVxuXG4gICAgY29uc3QgY29tcHV0ZWRCb3R0b20gPSBjb21wdXRlZDxzdHJpbmcgfCBib29sZWFuPigoKSA9PiB7XG4gICAgICByZXR1cm4gcHJvcHMuYm90dG9tICYmIGNhbGNQb3NpdGlvbihwcm9wcy5vZmZzZXRZKVxuICAgIH0pXG5cbiAgICBjb25zdCBjbGFzc2VzID0gY29tcHV0ZWQ8UmVjb3JkPHN0cmluZywgYm9vbGVhbj4+KCgpID0+ICh7XG4gICAgICAndi1iYWRnZSc6IHRydWUsXG4gICAgICAndi1iYWRnZS0tYm9yZGVyJzogcHJvcHMuYm9yZGVyLFxuICAgICAgJ3YtYmFkZ2UtLWRvdCc6IHByb3BzLmRvdCxcbiAgICAgICd2LWJhZGdlLS1hdmF0YXInOiBwcm9wcy5hdmF0YXIsXG4gICAgfSkpXG5cbiAgICBjb25zdCBiYWRnZUNsYXNzZXMgPSBjb21wdXRlZDxSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgJ3YtYmFkZ2VfX2JhZGdlJzogdHJ1ZSxcbiAgICAgICAgLi4uZWxldmF0aW9uQ2xhc3Nlcy52YWx1ZSxcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgY29uc3Qgc3R5bGVzID0gY29tcHV0ZWQ8UmVjb3JkPHN0cmluZywgc3RyaW5nIHwgYm9vbGVhbj4+KCgpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogY29tcHV0ZWRUb3AudmFsdWUsXG4gICAgICAgIHJpZ2h0OiBjb21wdXRlZFJpZ2h0LnZhbHVlLFxuICAgICAgICBib3R0b206IGNvbXB1dGVkQm90dG9tLnZhbHVlLFxuICAgICAgICBsZWZ0OiBjb21wdXRlZExlZnQudmFsdWUsXG4gICAgICB9XG4gICAgfSlcblxuICAgIGZ1bmN0aW9uIGFkZENvbnRlbnQoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgIGlmIChwcm9wcy5kb3QpIHJldHVybiB1bmRlZmluZWRcbiAgICAgIGlmIChwcm9wcy5jb250ZW50KSByZXR1cm4gU3RyaW5nKHByb3BzLmNvbnRlbnQpXG5cbiAgICAgIHJldHVybiB1bmRlZmluZWRcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZW5CYWRnZVNsb3QoKTogVk5vZGUgfCBudWxsIHtcbiAgICAgIGNvbnN0IHByb3BzRGF0YSA9IHtcbiAgICAgICAgY2xhc3M6IHtcbiAgICAgICAgICAndi1iYWRnZV9fYmFkZ2Utc2xvdCc6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzbG90cy5iYWRnZSA/IGgoJ2RpdicsXG4gICAgICAgIHByb3BzRGF0YSwgc2xvdHMuYmFkZ2UoKSkgOiBudWxsXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuQ29udGVudCgpOiBWTm9kZSB7XG4gICAgICBjb25zdCBwcm9wc0RhdGEgPSB7XG4gICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgJ3YtYmFkZ2VfX2NvbnRlbnQnOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaCgnZGl2JywgcHJvcHNEYXRhLCBbYWRkQ29udGVudCgpLCBnZW5CYWRnZVNsb3QoKV0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuQmFkZ2UoKTogVk5vZGUge1xuICAgICAgY29uc3QgcHJvcHNEYXRhID0gc2V0QmFja2dyb3VuZChcbiAgICAgICAgcHJvcHMuY29sb3IsIHtcbiAgICAgICAgICBjbGFzczogYmFkZ2VDbGFzc2VzLnZhbHVlLFxuICAgICAgICAgIHN0eWxlOiBzdHlsZXMudmFsdWUsXG4gICAgICAgIH0sXG4gICAgICApXG5cbiAgICAgIHJldHVybiBoKCdkaXYnLCBwcm9wc0RhdGEsIGdlbkNvbnRlbnQoKSlcbiAgICB9XG5cbiAgICByZXR1cm4gKCk6IFZOb2RlID0+IHtcbiAgICAgIGxldCBiYWRnZSA9IGdlbkJhZGdlKClcblxuICAgICAgaWYgKHByb3BzLnRvZ2dsZSAmJiAhc2xvdHMuYmFkZ2UpIHtcbiAgICAgICAgY29uc3QgeyBpc0FjdGl2ZSB9ID0gdXNlVG9nZ2xlKHByb3BzLCAnY29udGVudCcpXG4gICAgICAgIGJhZGdlID0gd2l0aERpcmVjdGl2ZXMoYmFkZ2UsIFtbdlNob3csIGlzQWN0aXZlLnZhbHVlXV0pXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHByb3BzRGF0YSA9IHtcbiAgICAgICAgY2xhc3M6IGNsYXNzZXMudmFsdWUsXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNoaWxkcmVuID0gW1xuICAgICAgICB1c2VUcmFuc2l0aW9uKGJhZGdlLCBwcm9wcy50cmFuc2l0aW9uKSxcbiAgICAgICAgc2xvdHMuZGVmYXVsdCAmJiBzbG90cy5kZWZhdWx0KCksXG4gICAgICBdXG5cbiAgICAgIHJldHVybiBoKCdkaXYnLCBwcm9wc0RhdGEsIGNoaWxkcmVuKVxuICAgIH1cbiAgfSxcbn0pXG4iXX0=