import './VCheckbox.scss';
import { h, ref, computed, defineComponent, inject } from 'vue';
import { useValidate } from '@/effects/use-validate';
import { VIcon } from '../VIcon';
import { VLabel } from '../VLabel';
import { FaIcons } from '../../services/icons';
import { warning } from '../../helpers';
export const VCheckbox = defineComponent({
    name: 'v-checkbox',
    props: {
        onIcon: {
            type: String,
            default: FaIcons.$checkOn,
        },
        offIcon: {
            type: String,
            default: FaIcons.$checkOff,
        },
        dark: Boolean,
        label: String,
        disabled: Boolean,
        validate: Boolean,
        modelValue: [Array, Boolean],
        value: {
            default: null,
        },
        color: {
            type: String,
            default: 'primary',
        },
    },
    setup(props, { emit }) {
        const isChecked = ref(false);
        const fields = props.validate && inject('fields');
        const { validate, validationState } = useValidate(props);
        const isArray = computed(() => Array.isArray(props.modelValue));
        const isValueSet = computed(() => props.value !== null);
        const classes = computed(() => ({
            'v-checkbox': true,
            'v-checkbox--disabled': props.disabled,
            'v-checkbox--checked': isChecked.value,
            'v-validatable': props.validate,
        }));
        if (isArray.value) {
            if (isValueSet.value) {
                isChecked.value = props.modelValue.includes(props.value);
            }
            else {
                warning('v-checkbox: set the "value" property');
            }
        }
        else {
            isChecked.value = !!props.modelValue;
        }
        if (fields?.value) {
            fields.value.push(validateValue);
        }
        function validateValue() {
            return validate(isChecked.value);
        }
        function genLabel() {
            const propsData = {
                absolute: false,
                color: props.dark ? 'white' : '',
                disabled: props.disabled,
                class: 'v-checkbox__label',
            };
            return h(VLabel, propsData, {
                default: () => props.label,
            });
        }
        function genIcon() {
            const icon = isChecked.value ? props.onIcon : props.offIcon;
            const propsData = {
                icon,
                size: 26,
                color: validationState.value,
                disabled: props.disabled,
            };
            return h(VIcon, propsData);
        }
        function genCheckbox() {
            const propsData = {
                class: {
                    'v-checkbox__square': true,
                },
            };
            return h('div', propsData, genIcon());
        }
        function computeValue() {
            let { modelValue } = props;
            if (isArray.value) {
                if (isValueSet.value) {
                    isChecked.value = !modelValue.includes(props.value);
                    if (!isChecked.value) {
                        modelValue = modelValue.filter(it => it !== props.value);
                    }
                    else {
                        modelValue.push(props.value);
                    }
                }
                else {
                    return (isChecked.value = !isChecked.value);
                }
                return modelValue;
            }
            return (isChecked.value = !isChecked.value);
        }
        function onClick() {
            if (props.disabled)
                return;
            const value = computeValue();
            props.validate && validateValue();
            emit('update:modelValue', value);
            emit('checked', value);
        }
        return () => {
            const dataProps = {
                class: classes.value,
                onClick,
            };
            return h('div', dataProps, [genCheckbox(), genLabel()]);
        };
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkNoZWNrYm94LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVkNoZWNrYm94L1ZDaGVja2JveC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLGtCQUFrQixDQUFBO0FBR3pCLE9BQU8sRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxlQUFlLEVBQUUsTUFBTSxFQUFFLE1BQU0sS0FBSyxDQUFBO0FBRy9ELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQTtBQUdwRCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBQ2hDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUE7QUFHbEMsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLHNCQUFzQixDQUFBO0FBRzlDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFLdkMsTUFBTSxDQUFDLE1BQU0sU0FBUyxHQUFHLGVBQWUsQ0FBQztJQUN2QyxJQUFJLEVBQUUsWUFBWTtJQUVsQixLQUFLLEVBQUU7UUFDTCxNQUFNLEVBQUU7WUFDTixJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxPQUFPLENBQUMsUUFBUTtTQUMxQjtRQUNELE9BQU8sRUFBRTtZQUNQLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLE9BQU8sQ0FBQyxTQUFTO1NBQzNCO1FBQ0QsSUFBSSxFQUFFLE9BQU87UUFDYixLQUFLLEVBQUUsTUFBTTtRQUNiLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLFVBQVUsRUFBRSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUM7UUFDNUIsS0FBSyxFQUFFO1lBQ0wsT0FBTyxFQUFFLElBQUk7U0FDZDtRQUNELEtBQUssRUFBRTtZQUNMLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLFNBQVM7U0FDbkI7S0FDSztJ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QUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQTtRQUN6RCxDQUFDLENBQUE7SUFDSCxDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gU3R5bGVzXG5pbXBvcnQgJy4vVkNoZWNrYm94LnNjc3MnXG5cbi8vIFZ1ZSBBUElcbmltcG9ydCB7IGgsIHJlZiwgY29tcHV0ZWQsIGRlZmluZUNvbXBvbmVudCwgaW5qZWN0IH0gZnJvbSAndnVlJ1xuXG4vLyBFZmZlY3RzXG5pbXBvcnQgeyB1c2VWYWxpZGF0ZSB9IGZyb20gJ0AvZWZmZWN0cy91c2UtdmFsaWRhdGUnXG5cbi8vIENvbXBvbmVudHNcbmltcG9ydCB7IFZJY29uIH0gZnJvbSAnLi4vVkljb24nXG5pbXBvcnQgeyBWTGFiZWwgfSBmcm9tICcuLi9WTGFiZWwnXG5cbi8vIFNlcnZpY2VzXG5pbXBvcnQgeyBGYUljb25zIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvaWNvbnMnXG5cbi8vIEhlbHBlcnNcbmltcG9ydCB7IHdhcm5pbmcgfSBmcm9tICcuLi8uLi9oZWxwZXJzJ1xuXG4vLyBUeXBlc1xuaW1wb3J0IHsgVk5vZGUsIFJlZiB9IGZyb20gJ3Z1ZSdcblxuZXhwb3J0IGNvbnN0IFZDaGVja2JveCA9IGRlZmluZUNvbXBvbmVudCh7XG4gIG5hbWU6ICd2LWNoZWNrYm94JyxcblxuICBwcm9wczoge1xuICAgIG9uSWNvbjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogRmFJY29ucy4kY2hlY2tPbixcbiAgICB9LFxuICAgIG9mZkljb246IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IEZhSWNvbnMuJGNoZWNrT2ZmLFxuICAgIH0sXG4gICAgZGFyazogQm9vbGVhbixcbiAgICBsYWJlbDogU3RyaW5nLFxuICAgIGRpc2FibGVkOiBCb29sZWFuLFxuICAgIHZhbGlkYXRlOiBCb29sZWFuLFxuICAgIG1vZGVsVmFsdWU6IFtBcnJheSwgQm9vbGVhbl0sXG4gICAgdmFsdWU6IHtcbiAgICAgIGRlZmF1bHQ6IG51bGwsXG4gICAgfSxcbiAgICBjb2xvcjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogJ3ByaW1hcnknLFxuICAgIH0sXG4gIH0gYXMgYW55LFxuXG4gIHNldHVwKHByb3BzLCB7IGVtaXQgfSk6ICgpID0+IFZOb2RlIHtcbiAgICBjb25zdCBpc0NoZWNrZWQgPSByZWYoZmFsc2UpXG4gICAgY29uc3QgZmllbGRzOiBSZWY8YW55W10+IHwgdW5kZWZpbmVkID0gcHJvcHMudmFsaWRhdGUgJiYgaW5qZWN0KCdmaWVsZHMnKVxuXG4gICAgY29uc3QgeyB2YWxpZGF0ZSwgdmFsaWRhdGlvblN0YXRlIH0gPSB1c2VWYWxpZGF0ZShwcm9wcylcblxuICAgIGNvbnN0IGlzQXJyYXkgPSBjb21wdXRlZDxib29sZWFuPigoKSA9PiBBcnJheS5pc0FycmF5KHByb3BzLm1vZGVsVmFsdWUpKVxuICAgIGNvbnN0IGlzVmFsdWVTZXQgPSBjb21wdXRlZDxib29sZWFuPigoKSA9PiBwcm9wcy52YWx1ZSAhPT0gbnVsbClcblxuICAgIGNvbnN0IGNsYXNzZXMgPSBjb21wdXRlZDxSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj4oKCkgPT4gKHtcbiAgICAgICd2LWNoZWNrYm94JzogdHJ1ZSxcbiAgICAgICd2LWNoZWNrYm94LS1kaXNhYmxlZCc6IHByb3BzLmRpc2FibGVkLFxuICAgICAgJ3YtY2hlY2tib3gtLWNoZWNrZWQnOiBpc0NoZWNrZWQudmFsdWUsXG4gICAgICAndi12YWxpZGF0YWJsZSc6IHByb3BzLnZhbGlkYXRlLFxuICAgIH0pKVxuXG4gICAgaWYgKGlzQXJyYXkudmFsdWUpIHtcbiAgICAgIGlmIChpc1ZhbHVlU2V0LnZhbHVlKSB7XG4gICAgICAgIGlzQ2hlY2tlZC52YWx1ZSA9IHByb3BzLm1vZGVsVmFsdWUuaW5jbHVkZXMocHJvcHMudmFsdWUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB3YXJuaW5nKCd2LWNoZWNrYm94OiBzZXQgdGhlIFwidmFsdWVcIiBwcm9wZXJ0eScpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlzQ2hlY2tlZC52YWx1ZSA9ICEhcHJvcHMubW9kZWxWYWx1ZVxuICAgIH1cblxuICAgIGlmIChmaWVsZHM/LnZhbHVlKSB7XG4gICAgICBmaWVsZHMhLnZhbHVlLnB1c2godmFsaWRhdGVWYWx1ZSlcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YWxpZGF0ZVZhbHVlKCk6IGJvb2xlYW4gfCB2b2lkIHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZShpc0NoZWNrZWQudmFsdWUpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuTGFiZWwoKTogVk5vZGUge1xuICAgICAgY29uc3QgcHJvcHNEYXRhID0ge1xuICAgICAgICBhYnNvbHV0ZTogZmFsc2UsXG4gICAgICAgIGNvbG9yOiBwcm9wcy5kYXJrID8gJ3doaXRlJyA6ICcnLFxuICAgICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQsXG4gICAgICAgIGNsYXNzOiAndi1jaGVja2JveF9fbGFiZWwnLFxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaChWTGFiZWwsIHByb3BzRGF0YSwge1xuICAgICAgICBkZWZhdWx0OiAoKSA9PiBwcm9wcy5sYWJlbCxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuSWNvbigpOiBWTm9kZSB7XG4gICAgICBjb25zdCBpY29uID0gaXNDaGVja2VkLnZhbHVlID8gcHJvcHMub25JY29uIDogcHJvcHMub2ZmSWNvblxuXG4gICAgICBjb25zdCBwcm9wc0RhdGEgPSB7XG4gICAgICAgIGljb24sXG4gICAgICAgIHNpemU6IDI2LFxuICAgICAgICBjb2xvcjogdmFsaWRhdGlvblN0YXRlLnZhbHVlLFxuICAgICAgICBkaXNhYmxlZDogcHJvcHMuZGlzYWJsZWQsXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBoKFZJY29uLCBwcm9wc0RhdGEpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2VuQ2hlY2tib3goKTogVk5vZGUge1xuICAgICAgY29uc3QgcHJvcHNEYXRhID0ge1xuICAgICAgICBjbGFzczoge1xuICAgICAgICAgICd2LWNoZWNrYm94X19zcXVhcmUnOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaCgnZGl2JywgcHJvcHNEYXRhLCBnZW5JY29uKCkpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcHV0ZVZhbHVlKCk6IGJvb2xlYW4gfCBhbnlbXSB7XG4gICAgICBsZXQgeyBtb2RlbFZhbHVlIH0gPSBwcm9wc1xuXG4gICAgICBpZiAoaXNBcnJheS52YWx1ZSkge1xuICAgICAgICBpZiAoaXNWYWx1ZVNldC52YWx1ZSkge1xuICAgICAgICAgIGlzQ2hlY2tlZC52YWx1ZSA9ICFtb2RlbFZhbHVlLmluY2x1ZGVzKHByb3BzLnZhbHVlKVxuXG4gICAgICAgICAgaWYgKCFpc0NoZWNrZWQudmFsdWUpIHtcbiAgICAgICAgICAgIG1vZGVsVmFsdWUgPSBtb2RlbFZhbHVlLmZpbHRlcihpdCA9PiBpdCAhPT0gcHJvcHMudmFsdWUpXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1vZGVsVmFsdWUucHVzaChwcm9wcy52YWx1ZSlcbiAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gKGlzQ2hlY2tlZC52YWx1ZSA9ICFpc0NoZWNrZWQudmFsdWUpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbW9kZWxWYWx1ZVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gKGlzQ2hlY2tlZC52YWx1ZSA9ICFpc0NoZWNrZWQudmFsdWUpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25DbGljaygpIHtcbiAgICAgIGlmIChwcm9wcy5kaXNhYmxlZCkgcmV0dXJuXG5cbiAgICAgIGNvbnN0IHZhbHVlID0gY29tcHV0ZVZhbHVlKClcblxuICAgICAgcHJvcHMudmFsaWRhdGUgJiYgdmFsaWRhdGVWYWx1ZSgpXG4gICAgICBlbWl0KCd1cGRhdGU6bW9kZWxWYWx1ZScsIHZhbHVlKVxuICAgICAgZW1pdCgnY2hlY2tlZCcsIHZhbHVlKVxuICAgIH1cblxuICAgIHJldHVybiAoKTogVk5vZGUgPT4ge1xuICAgICAgY29uc3QgZGF0YVByb3BzID0ge1xuICAgICAgICBjbGFzczogY2xhc3Nlcy52YWx1ZSxcbiAgICAgICAgb25DbGljayxcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGgoJ2RpdicsIGRhdGFQcm9wcywgW2dlbkNoZWNrYm94KCksIGdlbkxhYmVsKCldKVxuICAgIH1cbiAgfSxcbn0pXG4iXX0=