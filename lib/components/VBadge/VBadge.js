import { vShow, h, computed, withDirectives, defineComponent } from 'vue';
import { positionProps } from '../../composables/use-position';
import { useColors } from '../../composables/use-colors';
import { useToggle } from '../../composables/use-toggle';
import { useElevation, elevationProps } from '../../composables/use-elevation';
import { useTransition } from '../../composables/use-transition';
export default defineComponent({
    name: 'v-badge',
    props: {
        dot: Boolean,
        avatar: Boolean,
        border: Boolean,
        toggle: Boolean,
        content: {
            required: false,
        },
        color: {
            type: String,
            default: 'primary',
        },
        transition: {
            type: String,
            default: 'scaleIn',
        },
        offsetY: {
            type: [String, Number],
            default: 0
        },
        offsetX: {
            type: [String, Number],
            default: 0
        },
        ...positionProps(),
        ...elevationProps(),
    },
    setup(props, { slots }) {
        const { elevationClasses } = useElevation(props);
        const { setBackgroundClassNameColor, setBackgroundCssColor } = useColors();
        const offset = computed(() => {
            return props.dot ? 4 : 12;
        });
        const calcPosition = (offsetVal = 0) => {
            const value = offset.value - Number(offsetVal);
            return `${value}px`;
        };
        const computedLeft = computed(() => {
            return props.left && calcPosition(props.offsetX);
        });
        const computedRight = computed(() => {
            return props.right && calcPosition(props.offsetX);
        });
        const computedTop = computed(() => {
            return props.top && calcPosition(props.offsetY);
        });
        const computedBottom = computed(() => {
            return props.bottom && calcPosition(props.offsetY);
        });
        const classes = computed(() => ({
            'v-badge': true,
            'v-badge--border': props.border,
            'v-badge--dot': props.dot,
            'v-badge--avatar': props.avatar,
        }));
        const badgeClasses = computed(() => ({
            'v-badge__badge': true,
            ...elevationClasses.value,
            ...(props.color ? setBackgroundClassNameColor(props.color) : {}),
        }));
        const styles = computed(() => ({
            top: computedTop.value,
            right: computedRight.value,
            bottom: computedBottom.value,
            left: computedLeft.value,
            ...(props.color ? setBackgroundCssColor(props.color) : {}),
        }));
        const addContent = () => {
            if (props.dot)
                return undefined;
            if (props.content)
                return String(props.content);
            return undefined;
        };
        const genBadgeSlot = () => {
            const propsData = {
                class: {
                    'v-badge__badge-slot': true,
                },
            };
            return slots.badge ? h('div', propsData, slots.badge()) : null;
        };
        const genContent = () => {
            const propsData = {
                class: {
                    'v-badge__content': true,
                },
            };
            return h('div', propsData, [addContent(), genBadgeSlot()]);
        };
        const genBadge = () => {
            return h('div', {
                class: badgeClasses.value,
                style: styles.value,
            }, genContent());
        };
        return () => {
            let badge = genBadge();
            if (props.toggle && !slots.badge) {
                const { isActive } = useToggle(props, 'content');
                badge = withDirectives(badge, [[vShow, isActive.value]]);
            }
            const propsData = {
                class: classes.value,
            };
            const children = [
                useTransition(badge, props.transition),
                slots.default && slots.default(),
            ];
            return h('div', propsData, children);
        };
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkJhZGdlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVkJhZGdlL1ZCYWRnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLEtBQUssQ0FBQTtBQUd6RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sZ0NBQWdDLENBQUE7QUFDOUQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDhCQUE4QixDQUFBO0FBQ3hELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQTtBQUN4RCxPQUFPLEVBQUUsWUFBWSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlDQUFpQyxDQUFBO0FBQzlFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQTtBQU1oRSxlQUFlLGVBQWUsQ0FBQztJQUM3QixJQUFJLEVBQUUsU0FBUztJQUVmLEtBQUssRUFBRTtRQUNMLEdBQUcsRUFBRSxPQUFPO1FBQ1osTUFBTSxFQUFFLE9BQU87UUFDZixNQUFNLEVBQUUsT0FBTztRQUNmLE1BQU0sRUFBRSxPQUFPO1FBQ2YsT0FBTyxFQUFFO1lBQ1AsUUFBUSxFQUFFLEtBQUs7U0FDaEI7UUFDRCxLQUFLLEVBQUU7WUFDTCxJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxTQUFTO1NBQ25CO1FBQ0QsVUFBVSxFQUFFO1lBQ1YsSUFBSSxFQUFFLE1BQU07WUFDWixPQUFPLEVBQUUsU0FBUztTQUNuQjtRQUNELE9BQU8sRUFBRTtZQUNQLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUM7WUFDdEIsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUNELE9BQU8sRUFBRTtZQUNQLElBQUksRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUM7WUFDdEIsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUNE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QyxDQUFBO2dCQUNoRCxLQUFLLEdBQUcsY0FBYyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUE7YUFDekQ7WUFFRCxNQUFNLFNBQVMsR0FBRztnQkFDaEIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLO2FBQ3JCLENBQUE7WUFFRCxNQUFNLFFBQVEsR0FBRztnQkFDZixhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUM7Z0JBQ3RDLEtBQUssQ0FBQyxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sRUFBRTthQUNqQyxDQUFBO1lBRUQsT0FBTyxDQUFDLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQTtRQUN0QyxDQUFDLENBQUE7SUFDSCxDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVnVlIEFQSVxuaW1wb3J0IHsgdlNob3csIGgsIGNvbXB1dGVkLCB3aXRoRGlyZWN0aXZlcywgZGVmaW5lQ29tcG9uZW50IH0gZnJvbSAndnVlJ1xuXG4vLyBFZmZlY3RzXG5pbXBvcnQgeyBwb3NpdGlvblByb3BzIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZXMvdXNlLXBvc2l0aW9uJ1xuaW1wb3J0IHsgdXNlQ29sb3JzIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZXMvdXNlLWNvbG9ycydcbmltcG9ydCB7IHVzZVRvZ2dsZSB9IGZyb20gJy4uLy4uL2NvbXBvc2FibGVzL3VzZS10b2dnbGUnXG5pbXBvcnQgeyB1c2VFbGV2YXRpb24sIGVsZXZhdGlvblByb3BzIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZXMvdXNlLWVsZXZhdGlvbidcbmltcG9ydCB7IHVzZVRyYW5zaXRpb24gfSBmcm9tICcuLi8uLi9jb21wb3NhYmxlcy91c2UtdHJhbnNpdGlvbidcblxuLy8gVHlwZXNcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAndnVlJ1xuaW1wb3J0IHsgTWF5YmUgfSBmcm9tICcuLi8uLi8uLi90eXBlcy9iYXNlJ1xuXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBuYW1lOiAndi1iYWRnZScsXG5cbiAgcHJvcHM6IHtcbiAgICBkb3Q6IEJvb2xlYW4sXG4gICAgYXZhdGFyOiBCb29sZWFuLFxuICAgIGJvcmRlcjogQm9vbGVhbixcbiAgICB0b2dnbGU6IEJvb2xlYW4sXG4gICAgY29udGVudDoge1xuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICdwcmltYXJ5JyxcbiAgICB9LFxuICAgIHRyYW5zaXRpb246IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICdzY2FsZUluJyxcbiAgICB9LFxuICAgIG9mZnNldFk6IHtcbiAgICAgIHR5cGU6IFtTdHJpbmcsIE51bWJlcl0sXG4gICAgICBkZWZhdWx0OiAwXG4gICAgfSxcbiAgICBvZmZzZXRYOiB7XG4gICAgICB0eXBlOiBbU3RyaW5nLCBOdW1iZXJdLFxuICAgICAgZGVmYXVsdDogMFxuICAgIH0sXG4gICAgLi4ucG9zaXRpb25Qcm9wcygpLFxuICAgIC4uLmVsZXZhdGlvblByb3BzKCksXG4gIH0gYXMgYW55LFxuXG4gIHNldHVwKHByb3BzLCB7IHNsb3RzIH0pOiAoKSA9PiBWTm9kZSB7XG4gICAgY29uc3QgeyBlbGV2YXRpb25DbGFzc2VzIH0gPSB1c2VFbGV2YXRpb24ocHJvcHMpXG4gICAgY29uc3QgeyBzZXRCYWNrZ3JvdW5kQ2xhc3NOYW1lQ29sb3IsIHNldEJhY2tncm91bmRDc3NDb2xvciB9ID0gdXNlQ29sb3JzKClcblxuICAgIGNvbnN0IG9mZnNldCA9IGNvbXB1dGVkPG51bWJlcj4oKCkgPT4ge1xuICAgICAgcmV0dXJuIHByb3BzLmRvdCA/IDQgOiAxMlxuICAgIH0pXG5cbiAgICBjb25zdCBjYWxjUG9zaXRpb24gPSAob2Zmc2V0VmFsOiBzdHJpbmcgfCBudW1iZXIgPSAwKTogc3RyaW5nID0+IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gb2Zmc2V0LnZhbHVlIC0gTnVtYmVyKG9mZnNldFZhbClcbiAgICAgIHJldHVybiBgJHt2YWx1ZX1weGBcbiAgICB9XG5cbiAgICBjb25zdCBjb21wdXRlZExlZnQgPSBjb21wdXRlZDxzdHJpbmcgfCBib29sZWFuPigoKSA9PiB7XG4gICAgICByZXR1cm4gcHJvcHMubGVmdCAmJiBjYWxjUG9zaXRpb24ocHJvcHMub2Zmc2V0WClcbiAgICB9KVxuXG4gICAgY29uc3QgY29tcHV0ZWRSaWdodCA9IGNvbXB1dGVkPHN0cmluZyB8IGJvb2xlYW4+KCgpID0+IHtcbiAgICAgIHJldHVybiBwcm9wcy5yaWdodCAmJiBjYWxjUG9zaXRpb24ocHJvcHMub2Zmc2V0WClcbiAgICB9KVxuXG4gICAgY29uc3QgY29tcHV0ZWRUb3AgPSBjb21wdXRlZDxzdHJpbmcgfCBib29sZWFuPigoKSA9PiB7XG4gICAgICByZXR1cm4gcHJvcHMudG9wICYmIGNhbGNQb3NpdGlvbihwcm9wcy5vZmZzZXRZKVxuICAgIH0pXG5cbiAgICBjb25zdCBjb21wdXRlZEJvdHRvbSA9IGNvbXB1dGVkPHN0cmluZyB8IGJvb2xlYW4+KCgpID0+IHtcbiAgICAgIHJldHVybiBwcm9wcy5ib3R0b20gJiYgY2FsY1Bvc2l0aW9uKHByb3BzLm9mZnNldFkpXG4gICAgfSlcblxuICAgIGNvbnN0IGNsYXNzZXMgPSBjb21wdXRlZDxSZWNvcmQ8c3RyaW5nLCBib29sZWFuPj4oKCkgPT4gKHtcbiAgICAgICd2LWJhZGdlJzogdHJ1ZSxcbiAgICAgICd2LWJhZGdlLS1ib3JkZXInOiBwcm9wcy5ib3JkZXIsXG4gICAgICAndi1iYWRnZS0tZG90JzogcHJvcHMuZG90LFxuICAgICAgJ3YtYmFkZ2UtLWF2YXRhcic6IHByb3BzLmF2YXRhcixcbiAgICB9KSlcblxuICAgIGNvbnN0IGJhZGdlQ2xhc3NlcyA9IGNvbXB1dGVkPFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+PigoKSA9PiAoe1xuICAgICAgJ3YtYmFkZ2VfX2JhZGdlJzogdHJ1ZSxcbiAgICAgIC4uLmVsZXZhdGlvbkNsYXNzZXMudmFsdWUsXG4gICAgICAuLi4ocHJvcHMuY29sb3IgPyBzZXRCYWNrZ3JvdW5kQ2xhc3NOYW1lQ29sb3IocHJvcHMuY29sb3IpIDoge30pLFxuICAgIH0pKVxuXG4gICAgY29uc3Qgc3R5bGVzID0gY29tcHV0ZWQ8UmVjb3JkPHN0cmluZywgc3RyaW5nIHwgYm9vbGVhbj4+KCgpID0+ICh7XG4gICAgICB0b3A6IGNvbXB1dGVkVG9wLnZhbHVlLFxuICAgICAgcmlnaHQ6IGNvbXB1dGVkUmlnaHQudmFsdWUsXG4gICAgICBib3R0b206IGNvbXB1dGVkQm90dG9tLnZhbHVlLFxuICAgICAgbGVmdDogY29tcHV0ZWRMZWZ0LnZhbHVlLFxuICAgICAgLi4uKHByb3BzLmNvbG9yID8gc2V0QmFja2dyb3VuZENzc0NvbG9yKHByb3BzLmNvbG9yKSA6IHt9KSxcbiAgICB9KSlcblxuICAgIGNvbnN0IGFkZENvbnRlbnQgPSAoKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgICAgIGlmIChwcm9wcy5kb3QpIHJldHVybiB1bmRlZmluZWRcbiAgICAgIGlmIChwcm9wcy5jb250ZW50KSByZXR1cm4gU3RyaW5nKHByb3BzLmNvbnRlbnQpXG5cbiAgICAgIHJldHVybiB1bmRlZmluZWRcbiAgICB9XG5cbiAgICBjb25zdCBnZW5CYWRnZVNsb3QgPSAoKTogTWF5YmU8Vk5vZGU+ID0+IHtcbiAgICAgIGNvbnN0IHByb3BzRGF0YSA9IHtcbiAgICAgICAgY2xhc3M6IHtcbiAgICAgICAgICAndi1iYWRnZV9fYmFkZ2Utc2xvdCc6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzbG90cy5iYWRnZSA/IGgoJ2RpdicsIHByb3BzRGF0YSwgc2xvdHMuYmFkZ2UoKSkgOiBudWxsXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuQ29udGVudCA9ICgpOiBWTm9kZSA9PiB7XG4gICAgICBjb25zdCBwcm9wc0RhdGEgPSB7XG4gICAgICAgIGNsYXNzOiB7XG4gICAgICAgICAgJ3YtYmFkZ2VfX2NvbnRlbnQnOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfVxuXG4gICAgICByZXR1cm4gaCgnZGl2JywgcHJvcHNEYXRhLCBbYWRkQ29udGVudCgpLCBnZW5CYWRnZVNsb3QoKV0pXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuQmFkZ2UgPSAoKTogVk5vZGUgPT4ge1xuICAgICAgcmV0dXJuIGgoXG4gICAgICAgICdkaXYnLFxuICAgICAgICB7XG4gICAgICAgICAgY2xhc3M6IGJhZGdlQ2xhc3Nlcy52YWx1ZSxcbiAgICAgICAgICBzdHlsZTogc3R5bGVzLnZhbHVlLFxuICAgICAgICB9LFxuICAgICAgICBnZW5Db250ZW50KClcbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgbGV0IGJhZGdlID0gZ2VuQmFkZ2UoKVxuXG4gICAgICBpZiAocHJvcHMudG9nZ2xlICYmICFzbG90cy5iYWRnZSkge1xuICAgICAgICBjb25zdCB7IGlzQWN0aXZlIH0gPSB1c2VUb2dnbGUocHJvcHMsICdjb250ZW50JylcbiAgICAgICAgYmFkZ2UgPSB3aXRoRGlyZWN0aXZlcyhiYWRnZSwgW1t2U2hvdywgaXNBY3RpdmUudmFsdWVdXSlcbiAgICAgIH1cblxuICAgICAgY29uc3QgcHJvcHNEYXRhID0ge1xuICAgICAgICBjbGFzczogY2xhc3Nlcy52YWx1ZSxcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2hpbGRyZW4gPSBbXG4gICAgICAgIHVzZVRyYW5zaXRpb24oYmFkZ2UsIHByb3BzLnRyYW5zaXRpb24pLFxuICAgICAgICBzbG90cy5kZWZhdWx0ICYmIHNsb3RzLmRlZmF1bHQoKSxcbiAgICAgIF1cblxuICAgICAgcmV0dXJuIGgoJ2RpdicsIHByb3BzRGF0YSwgY2hpbGRyZW4pXG4gICAgfVxuICB9LFxufSlcbiJdfQ==