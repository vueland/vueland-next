{"version":3,"sources":["../../../../src/components/VResize/VResize.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VResize.scss'\n\n// Vue API\nimport {\n  h,\n  ref,\n  computed,\n  reactive,\n  defineComponent,\n  onMounted,\n  onBeforeUnmount,\n} from 'vue'\n\n// Effects\nimport { positionProps } from '../../effects/use-position'\n\n// Types\nimport { VNode } from 'vue'\n\ntype ResizeData = {\n  parentNode: HTMLElement | null\n  startOffset: number | null\n  offsetTop: number\n  offsetLeft: number\n  parentHeight: number\n  parentWidth: number\n  marginLeft: number\n  marginTop: number\n  left: number\n  top: number\n  isActive: boolean\n}\n\nexport const VResize = defineComponent({\n  name: 'v-resize',\n\n  props: {\n    emit: {\n      type: Boolean,\n      default: false,\n    },\n\n    customClass: {\n      type: String,\n    },\n\n    minSize: {\n      type: [String, Number],\n      default: 50,\n    },\n    ...positionProps(),\n  } as any,\n\n  setup(props, { emit }): () => VNode {\n    const data: ResizeData = reactive({\n      parentNode: null,\n      startOffset: null,\n      offsetTop: 0,\n      offsetLeft: 0,\n      parentHeight: 0,\n      parentWidth: 0,\n      marginLeft: 0,\n      marginTop: 0,\n      left: 0,\n      top: 0,\n      isActive: false,\n    })\n\n    const resRef = ref<HTMLElement | null>(null)\n\n    const classes = computed<Record<string, boolean>>(() => {\n      return {\n        'v-resize': true,\n        'v-resize--active': data.isActive,\n        'v-resize--top': props.top,\n        'v-resize--bottom': props.bottom,\n        'v-resize--right': props.right,\n        'v-resize--left': props.left,\n        [props.customClass]: !!props.customClass,\n      }\n    })\n\n    const isDirectY = computed<boolean>(() => {\n      return props.top || props.bottom\n    })\n\n    const isNeedReverse = computed<boolean>(() => {\n      return props.top || props.left\n    })\n\n    const currentSize = computed<number>(() => {\n      return isDirectY.value ? data.parentHeight! : data.parentWidth!\n    })\n\n    const sizeProp = computed<string>(() => {\n      return isDirectY.value ? 'height' : 'width'\n    })\n\n    const reverseDirection = computed<string>(() => {\n      return props.top ? 'top' : 'left'\n    })\n\n    const reverseOffsetKey = computed<string>(() => {\n      const side = reverseDirection.value\n      return 'offset' + side[0].toUpperCase() + side.slice(1)\n    })\n\n    const offset = computed<number>(() => {\n      return isDirectY.value ? data.offsetTop! : data.offsetLeft!\n    })\n\n    const direction = computed<string>(() => {\n      return isDirectY.value ? 'clientY' : 'clientX'\n    })\n\n    function moveReverse(size) {\n      const { parentNode, left, top } = data\n      const reverseTo = reverseDirection.value\n\n      const value = !isDirectY.value\n        ? currentSize.value - size + left\n        : currentSize.value - size + top\n\n      parentNode!.style[reverseTo] = `${ value }px`\n    }\n\n    function setOrEmitSize(size) {\n      if (props.emit) return emit('size', size)\n\n      data.parentNode!.style[sizeProp.value] = `${ size }px`\n\n      isNeedReverse.value && moveReverse(size)\n    }\n\n    function resize(e) {\n      let size\n\n      if (isNeedReverse.value) {\n        size = currentSize.value - (e[direction.value] - offset.value) +\n          data.startOffset!\n      } else {\n        size = currentSize.value + (e[direction.value] - currentSize.value -\n          offset.value - data.startOffset!)\n      }\n\n      size > props.minSize && setOrEmitSize(size)\n    }\n\n    function resetMinMaxStyles() {\n      if (isDirectY.value) {\n        data.parentNode!.style.maxHeight = ''\n        data.parentNode!.style.minHeight = ''\n      } else {\n        data.parentNode!.style.maxWidth = ''\n        data.parentNode!.style.minWidth = ''\n      }\n    }\n\n    function setParent() {\n      const parent = resRef.value!.parentNode\n      data.parentNode = parent as HTMLElement\n    }\n\n    function computeSizes() {\n      const {\n        top,\n        left,\n        height,\n        width,\n        marginLeft,\n        marginTop,\n      } = getComputedStyle(data.parentNode!)\n\n      data.offsetTop = data.parentNode!.offsetTop\n      data.offsetLeft = data.parentNode!.offsetLeft\n      data.marginLeft = parseFloat(marginLeft)\n      data.marginTop = parseFloat(marginTop)\n      data.parentHeight = parseFloat(height)\n      data.parentWidth = parseFloat(width)\n      data.top = parseFloat(top)\n      data.left = parseFloat(left)\n    }\n\n    function setStartPositions() {\n      const side = reverseDirection.value\n      const offset = reverseOffsetKey.value\n\n      if (data[side] === data[offset]) {\n        data.parentNode!.style[side] = `${ data[offset] }px`\n      }\n    }\n\n    function disableSelection(e) {\n      e.preventDefault()\n    }\n\n    function initResize(e) {\n      if (!data.isActive) {\n        data.isActive = true\n        computeSizes()\n        resetMinMaxStyles()\n        setStartPositions()\n        setStartOffset(e)\n      }\n\n      requestAnimationFrame(() => resize(e))\n    }\n\n    function setStartOffset(e) {\n      if (isNeedReverse.value) data.startOffset = e[direction.value]\n      else data.startOffset = e[direction.value] - currentSize.value\n\n      data.startOffset! -= offset.value\n    }\n\n    function reset() {\n      data.isActive = false\n      resetMinMaxStyles()\n    }\n\n    function onMouseup() {\n      reset()\n      removeHandlers()\n    }\n\n    function onMousedown() {\n      document.addEventListener('mousemove', initResize)\n      document.addEventListener('mouseup', onMouseup)\n      document.addEventListener('selectstart', disableSelection)\n    }\n\n    function removeHandlers() {\n      document.removeEventListener('mousemove', initResize)\n      document.removeEventListener('mouseup', onMouseup)\n      document.removeEventListener('selectstart', disableSelection)\n    }\n\n    onMounted(() => {\n      setParent()\n    })\n\n    onBeforeUnmount(() => {\n      document.removeEventListener('mousedown', onMousedown)\n    })\n\n    return () =>\n      h('div', {\n        class: {\n          ...classes.value,\n        },\n        key: 'resize',\n        ref: resRef,\n        onMousedown,\n      })\n  },\n})\n"],"sourceRoot":"","file":"VResize.js"}