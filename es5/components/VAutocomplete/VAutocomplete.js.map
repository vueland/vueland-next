{"version":3,"sources":["../../../../src/components/VAutocomplete/VAutocomplete.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VAutocomplete.scss'\n\n// Vue API\nimport { h, ref, reactive, computed, defineComponent } from 'vue'\n\n// Effects\nimport { validateProps } from '../../effects/use-validate'\nimport { colorProps, useColors } from '../../effects/use-colors'\nimport { useTheme } from '../../effects/use-theme'\n\n// Types\nimport { VNode } from 'vue'\n\n// Components\nimport { VInput } from '../VInput'\nimport { VAutocompleteList } from './VAutocompleteList'\nimport { VMenu } from '../VMenu'\n\ntype SelectState = {\n  focused: boolean\n  isMenuActive: boolean\n  search: string\n}\n\nexport const VAutocomplete = defineComponent({\n  name: 'v-autocomplete',\n  props: {\n    label: String,\n    items: Array,\n    dark: Boolean,\n    valueKey: String,\n    idKey: String,\n    listColor: String,\n    disabled: Boolean,\n    modelValue: {\n      default: null,\n    },\n    ...validateProps(),\n    ...colorProps(),\n  } as any,\n  emits: [\n    'input',\n    'blur',\n    'focus',\n    'select',\n    'update:modelValue',\n    'update:value',\n  ],\n\n  setup(props, { emit }): () => VNode {\n    const state: SelectState = reactive({\n      focused: false,\n      isMenuActive: false,\n      search: '',\n    })\n\n    const { setTextColor } = useColors()\n    const { base } = useTheme()\n    const inputRef = ref(null)\n\n    const classes = computed<Record<string, boolean>>(() => ({\n      'v-autocomplete': true,\n      'v-autocomplete--disabled': props.disabled,\n      'v-autocomplete--focused': state.focused,\n    }))\n\n    const valueProperty = computed<any>(() => {\n      return props.modelValue || props.value\n    })\n\n    const inputValue = computed<string>(() => {\n      return props.valueKey\n        ? valueProperty.value[props.valueKey]\n        : valueProperty.value\n    })\n\n    const isListItemsExists = computed<boolean>(() => {\n      return !!props.items && !!props.items.length\n    })\n\n    state.search = valueProperty.value ? inputValue.value : ''\n\n    function onFocus() {\n      state.focused = true\n      state.isMenuActive = isListItemsExists.value\n      emit('focus')\n    }\n\n    function onBlur() {\n      if (!valueProperty.value) state.search = ''\n\n      if (!state.search && valueProperty.value) {\n        state.search = inputValue.value\n      }\n      state.focused = false\n      emit('blur')\n    }\n\n    function onInput(e) {\n      state.search = e.target.value\n      emit('input', e.target.value)\n    }\n\n    function onClear() {\n      state.search = ''\n      emit('select', '')\n      emit('update:modelValue', '')\n      emit('update:value', '')\n    }\n\n    function onSelect(it) {\n      state.search = props.valueKey ? it[props.valueKey] : it\n      emit('select', it)\n      emit('update:modelValue', it)\n      emit('update:value', it)\n    }\n\n    function genInput(): VNode {\n      const propsData = {\n        value: state.search,\n        disabled: props.disabled,\n        readonly: props.readonly && !props.typeable,\n        ref: inputRef,\n        class: 'v-autocomplete__input',\n        onInput,\n        onFocus,\n      }\n\n      return h('input', setTextColor(props.dark ? 'white' : base, propsData))\n    }\n\n    function genAutocompleteList(): VNode {\n      const propsData = {\n        items: props.items,\n        valueKey: props.valueKey,\n        idKey: props.idKey,\n        active: state.isMenuActive,\n        color: props.dark ? 'white' : base,\n        listColor: props.listColor,\n        onSelect,\n      }\n      return h(VAutocompleteList, propsData)\n    }\n\n    function genMenu() {\n      return h(\n        VMenu,\n        {\n          activator: inputRef,\n          openOnClick: true,\n          maxHeight: 240,\n          bottom: true,\n          onClose: () => onBlur(),\n        },\n        {\n          default: genAutocompleteList,\n        }\n      )\n    }\n\n    function genAutocomplete(): VNode {\n      return h('div', { class: classes.value }, [genInput(), genMenu()])\n    }\n\n    return () => {\n      const propsData = {\n        label: props.label,\n        focused: state.focused,\n        hasState: !!valueProperty.value || !!state.search,\n        dark: props.dark,\n        disabled: props.disabled,\n        clearable: props.clearable,\n        rules: props.rules,\n        value: valueProperty.value || state.search,\n        onClear,\n      }\n\n      return h(VInput, propsData, {\n        textField: () => genAutocomplete(),\n      })\n    }\n  },\n})\n"],"sourceRoot":"","file":"VAutocomplete.js"}