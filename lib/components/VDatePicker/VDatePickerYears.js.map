{"version":3,"sources":["../../../../src/components/VDatePicker/VDatePickerYears.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VDatePickerYears.scss'\n\n// VUe API\nimport { h, ref, watchEffect, inject, computed, defineComponent } from 'vue'\n\n// Helpers\nimport { genTableRows } from './helpers'\n\n// Types\nimport { VNode, Ref } from 'vue'\nimport { DatePickerBtnHandlers } from '../../types'\n\n// Effects\nimport { useTransition } from '../../effects/use-transition'\n\nexport const VDatePickerYears = defineComponent({\n  name: 'v-date-picker-years',\n  props: {\n    year: [Number, String],\n  } as any,\n\n  setup(props, { emit }) {\n    const LIMIT = 100\n    const ON_TABLE = 20\n    const CELLS_IN_ROW = 4\n    const CURRENT_YEAR = new Date().getFullYear()\n    const ANIMATION_TIMEOUT = 100\n\n    const years = ref<Array<number[]>>([])\n    const onTableIndex = ref<number>(0)\n    const isListChanged = ref<boolean>(false)\n    const transition = ref<string>('')\n\n    const handlers = inject('handlers') as Ref<DatePickerBtnHandlers>\n\n    watchEffect(\n      () => isListChanged.value &&\n        setTimeout(() => {\n          isListChanged.value = false\n        }, ANIMATION_TIMEOUT),\n    )\n\n    const computedYear = computed<number>({\n      get() {\n        return +props.year! || CURRENT_YEAR\n      },\n      set(val: number) {\n        emit('update:year', val)\n      },\n    })\n\n    if (handlers?.value) {\n      handlers.value = {\n        onNext: () => changeYearsList(true),\n        onPrev: () => changeYearsList(false),\n      }\n    }\n\n    function setCurrentTransition(isNext) {\n      transition.value = isNext ? 'fade-in-down' : 'fade-in-up'\n    }\n\n    function setTableIndex() {\n      onTableIndex.value = years.value.findIndex(row => {\n        return row.find(year => year === computedYear.value)\n      })\n    }\n\n    function changeYearsList(isNext) {\n      const max = years.value.length - 1\n      const val = isNext ? 1 : -1\n\n      if (\n        (onTableIndex.value === max && val > 0) ||\n        (onTableIndex.value === 0 && val < 0)\n      ) return\n\n      setCurrentTransition(isNext)\n\n      onTableIndex.value += val\n      isListChanged.value = true\n    }\n\n    function genTableYears() {\n      const fromYear = CURRENT_YEAR - LIMIT\n      const maxYears = LIMIT * 2\n\n      let yearsList: number[] = []\n\n      for (let i = 0; i <= maxYears; i += 1) {\n        if (yearsList.length === ON_TABLE) {\n          years.value.push(yearsList)\n          yearsList = []\n        }\n        yearsList.push(fromYear + i)\n      }\n    }\n\n    function genYearCell(year): VNode {\n      const isSelected = year === computedYear.value\n      const propsData = {\n        class: {\n          'v-date-picker-years__cell': true,\n          'v-date-picker-years__cell--selected': isSelected,\n          'v-date-picker-years__cell--current-year': year === CURRENT_YEAR,\n        },\n        onClick: () => (computedYear.value = year),\n      }\n\n      return h('div', propsData, year)\n    }\n\n    function genYearsRows(): VNode[] {\n      const currentYears = years.value[onTableIndex.value]\n      const yearsVNodes = currentYears.map(genYearCell)\n\n      return genTableRows(\n        yearsVNodes,\n        'v-date-picker-years__row',\n        CELLS_IN_ROW,\n      )\n    }\n\n    function genYears(): VNode | null {\n      const propsData = {\n        class: 'v-date-picker-years__years',\n      }\n      return (\n        !isListChanged.value && h('div', propsData, genYearsRows()) || null\n      )\n    }\n\n    genTableYears()\n    setTableIndex()\n\n    return () => {\n      const content = useTransition(\n        genYears() as VNode,\n        transition.value,\n      )\n      const propsData = {\n        class: {\n          'v-date-picker-years': true,\n        },\n      }\n\n      return h('div', propsData, content)\n    }\n  },\n})\n"],"sourceRoot":"","file":"VDatePickerYears.js"}