{"version":3,"sources":["../../../../src/components/VSelect/VSelect.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VSelect.scss'\n\n// Vue API\nimport {\n  h,\n  reactive,\n  computed,\n  defineComponent,\n  watch,\n  inject,\n  onBeforeUnmount,\n} from 'vue'\n\n// Effects\nimport { validateProps, useValidate } from '../../effects/use-validate'\nimport { colorProps, useColors } from '../../effects/use-colors'\nimport { useTheme } from '../../effects/use-theme'\n\n// Types\nimport { VNode, Ref } from 'vue'\n\n// Components\nimport { VInput } from '../VInput'\nimport { VSelectList } from './VSelectList'\nimport { VMenu } from '../VMenu'\n\ntype SelectState = {\n  selected: any | null\n  focused: boolean\n}\n\nexport const VSelect = defineComponent({\n  name: 'v-select',\n\n  props: {\n    label: String,\n    items: Array,\n    dark: Boolean,\n    valueKey: String,\n    idKey: String,\n    listColor: String,\n    disabled: Boolean,\n    readonly: Boolean,\n    clearable: Boolean,\n    modelValue: [Array, String, Object, Number],\n    ...validateProps(),\n    ...colorProps(),\n  } as any,\n\n  emits: [\n    'input',\n    'blur',\n    'focus',\n    'select',\n    'update:modelValue',\n    'update:value',\n  ],\n\n  setup(props, { emit, attrs }): () => VNode {\n    const state: SelectState = reactive({\n      selected: null,\n      focused: false,\n    })\n\n    const { setTextColor } = useColors()\n    const { base } = useTheme()\n    const {\n      validate,\n      dirty,\n      update,\n      errorState,\n      validationState,\n    } = useValidate(props)\n\n    const fields: Ref<any[]> | undefined = props.rules && inject('fields')\n\n    const classes = computed<Record<string, boolean>>(() => ({\n      'v-select': true,\n      'v-select--disabled': props.disabled,\n      'v-select--readonly': props.readonly,\n      'v-select--focused': state.focused,\n    }))\n\n    const computedInputValue = computed<string>(() => {\n      return state.selected\n        ? props.valueKey\n          ? state.selected[props.valueKey]\n          : state.selected\n        : ''\n    })\n\n    const computedValue = computed<any>(() => {\n      return props.modelValue || props.value\n    })\n\n    watch(\n      () => computedValue.value,\n      (value) => {\n        state.selected = value\n        !state.focused &&\n          errorState.isDirty &&\n          props.rules?.length &&\n          validateValue()\n      },\n      { immediate: true }\n    )\n\n    if (fields?.value && props.rules?.length) {\n      fields.value.push(validateValue)\n    }\n\n    function validateValue() {\n      return props.rules?.length && validate(computedInputValue.value)\n    }\n\n    function toggleState() {\n      state.focused = !state.focused\n    }\n\n    function onBlur() {\n      setTimeout(() => {\n        requestAnimationFrame(validateValue)\n        toggleState()\n        emit('blur')\n      })\n    }\n\n    function onClick() {\n      dirty()\n      update(errorState.innerError)\n      toggleState()\n      emit('focus')\n    }\n\n    function onClear() {\n      state.selected = ''\n      requestAnimationFrame(validateValue)\n    }\n\n    function selectItem(item) {\n      state.selected = item\n      emit('select', item)\n      emit('update:value', item)\n      emit('update:modelValue', item)\n    }\n\n    function genInput(): VNode {\n      const propsData = {\n        value: computedInputValue.value,\n        disabled: props.disabled,\n        readonly: props.readonly && !props.typeable,\n        class: 'v-select__input',\n        onClick,\n      }\n      return h('input', setTextColor(props.dark ? 'white' : base, propsData))\n    }\n\n    function genSelectList(): VNode {\n      const propsData = {\n        items: props.items,\n        valueKey: props.valueKey,\n        idKey: props.idKey,\n        active: state.focused,\n        color: props.dark ? 'white' : base,\n        listColor: props.listColor || 'white',\n        onSelect: (item) => selectItem(item),\n      }\n      return h(VSelectList, propsData)\n    }\n\n    function genSelect(): VNode {\n      const propsData = {\n        class: classes.value,\n      }\n\n      return h('div', propsData, genInput())\n    }\n\n    onBeforeUnmount(() => {\n      if (fields?.value) {\n        fields!.value = fields!.value.filter((v) => v !== validateValue)\n      }\n    })\n\n    return () => {\n      const propsData = {\n        label: props.label,\n        focused: state.focused,\n        hasState: !!computedInputValue.value,\n        hasError: errorState.innerError,\n        dark: props.dark,\n        color: validationState.value,\n        disabled: props.disabled,\n        isDirty: !!errorState.isDirty,\n        message: errorState.innerErrorMessage,\n        clearable: props.clearable,\n        onClear,\n        ...attrs,\n      } as any\n\n      const menuContent = {\n        activator: () => genSelect(),\n        content: () => props.items && genSelectList(),\n      }\n\n      return h(VInput, propsData, {\n        select: () =>\n          h(\n            VMenu,\n            {\n              openOnClick: true,\n              maxHeight: 400,\n              offsetY: props.typeable ? 1 : 0,\n              onClose: () => onBlur(),\n            },\n            menuContent\n          ),\n      })\n    }\n  },\n})\n"],"sourceRoot":"","file":"VSelect.js"}