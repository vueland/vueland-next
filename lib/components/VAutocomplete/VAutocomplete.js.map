{"version":3,"sources":["../../../../src/components/VAutocomplete/VAutocomplete.ts"],"names":[],"mappings":"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","sourcesContent":["// Styles\nimport './VAutocomplete.scss'\n\n// Vue API\nimport { h, ref, reactive, computed, defineComponent, onBeforeMount } from 'vue'\n\n// Effects\nimport { validateProps } from '../../effects/use-validate'\nimport { useColors } from '../../effects/use-colors'\nimport { useTheme } from '../../effects/use-theme'\n\n// Types\nimport { VNode } from 'vue'\n\n// Components\nimport { VInput } from '../VInput'\nimport { VSelectList } from '../VSelect'\nimport { VMenu } from '../VMenu'\nimport { VProgressLinear } from '../VProgressLinear'\n\n// Helpers\nimport { getKeyValueFromTarget } from '../../helpers'\n\ntype SelectState = {\n  focused: boolean\n  isMenuActive: boolean\n  search: string,\n  select: any\n}\n\nexport const VAutocomplete = defineComponent({\n  name: 'v-autocomplete',\n  props: {\n    label: String,\n    items: Array,\n    dark: Boolean,\n    valueKey: String,\n    idKey: String,\n    listColor: String,\n    disabled: Boolean,\n    typeable: Boolean,\n    loading: Boolean,\n    modelValue: {\n      default: null\n    },\n    color: {\n      type: String,\n      default: 'primary'\n    },\n    ...validateProps()\n  } as any,\n\n  emits: [\n    'input',\n    'blur',\n    'focus',\n    'select',\n    'update:modelValue',\n    'update:value'\n  ],\n\n  setup(props, { emit }): () => VNode {\n    const state: SelectState = reactive({\n      focused: false,\n      isMenuActive: false,\n      search: '',\n      select: null\n    })\n\n    const { setTextColor } = useColors()\n    const { base } = useTheme()\n    const inputRef = ref(null)\n\n    const classes = computed<Record<string, boolean>>(() => ({\n      'v-autocomplete': true,\n      'v-autocomplete--disabled': props.disabled,\n      'v-autocomplete--focused': state.focused\n    }))\n\n    const valueProperty = computed<any>(() => {\n      return props.modelValue || props.value\n    })\n\n    const inputValue = computed<string>(() => {\n      return props.valueKey && valueProperty.value\n        ? getKeyValueFromTarget(props.valueKey, valueProperty.value)\n        : valueProperty.value\n    })\n\n    function onFocus() {\n      state.focused = true\n      state.isMenuActive = true\n      emit('focus')\n    }\n\n    function onBlur() {\n      if (!valueProperty.value && !state.search) state.search = ''\n      if (!state.search && valueProperty.value) state.search = inputValue.value\n      state.focused = false\n      emit('blur')\n    }\n\n    function onInput(e) {\n      state.search = e.target.value\n      emit('input', e.target.value)\n    }\n\n    function onClear() {\n      state.search = ''\n      state.select = null\n      emit('select', null)\n      emit('update:modelValue', null)\n      emit('update:value', null)\n    }\n\n    function onSelect(it) {\n      state.search = props.valueKey ? getKeyValueFromTarget(props.valueKey, it) : it\n      state.select = it\n      emit('select', it)\n      emit('update:modelValue', it)\n      emit('update:value', it)\n    }\n\n    function genInput(): VNode {\n      const propsData = {\n        value: state.search,\n        disabled: props.disabled,\n        readonly: props.readonly && !props.typeable,\n        ref: inputRef,\n        class: 'v-autocomplete__input',\n        onInput,\n        onFocus,\n        onBlur\n      }\n\n      return h('input', setTextColor(props.dark ? 'white' : base, propsData))\n    }\n\n    function genAutocompleteList(): VNode {\n      const propsData = {\n        items: props.items,\n        valueKey: props.valueKey,\n        idKey: props.idKey,\n        active: state.isMenuActive,\n        color: props.dark ? 'white' : props.color,\n        listColor: props.listColor,\n        select: state.select,\n        onSelect\n      }\n      return h(VSelectList, propsData)\n    }\n\n    function genMenu() {\n      return h(\n        VMenu,\n        {\n          activator: inputRef,\n          openOnClick: true,\n          maxHeight: 240,\n          bottom: true,\n          onClose: () => state.isMenuActive = state.focused\n        },\n        {\n          default: genAutocompleteList\n        }\n      )\n    }\n\n    function genLinearProgress() {\n      return h('div', {\n        class: { 'v-autocomplete__loading': true }\n      }, h(VProgressLinear, {\n        height: 2,\n        indeterminate: true,\n        color: props.color,\n        backgroundColor: props.color\n      }))\n    }\n\n    function genAutocomplete(): VNode {\n      return h('div', { class: classes.value }, [\n        genInput(),\n        props.loading && genLinearProgress(),\n        genMenu()\n      ])\n    }\n\n    onBeforeMount(() => {\n      state.select = valueProperty.value\n      state.search = inputValue.value\n    })\n\n    return () => {\n      const propsData = {\n        label: props.label,\n        focused: state.isMenuActive,\n        hasState: !!state.search,\n        dark: props.dark,\n        disabled: props.disabled,\n        clearable: props.clearable,\n        color: props.color,\n        rules: props.rules,\n        value: valueProperty.value || state.search,\n        onClear\n      }\n\n      return h(VInput, propsData, {\n        textField: () => genAutocomplete()\n      })\n    }\n  }\n})\n"],"sourceRoot":"","file":"VAutocomplete.js"}